{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\src\\\\singlePlatform\\\\singlePlatForm.js\";\nimport React from 'react';\nimport { Component } from 'react';\nimport './singlePlatForm.css';\nimport { Media } from 'reactstrap';\nimport Axios from \"axios\"; // const places = \n// \t[\n// \t\t{\n// \t\t\tid: 0,\n// \t\t\tname: 'user1',\n// \t\t\timage: './account.jpg', \n// \t\t\treputation:2\n// \t\t} ,\n// \t\t{\n// \t\t\tid: 0,\n// \t\t\tname: 'user3',\n// \t\t\timage: './popMusic.jpg',\n// \t\t\treputation:2\n// \t\t} ,{\n// \t\t\tid: 0,\n// \t\t\tname: 'user2',\n// \t\t\timage: './classicMusic.jpg',\n// \t\t\treputation:2\n// \t\t}  \t];\n\nexport default class singlePlatForm extends Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n\n    this.componentDidMount = () => {\n      this.get();\n      this.get_ranklist();\n      this.setState({\n        rander: true\n      });\n      this.is_sub();\n    };\n\n    this.state = {\n      //决定是否显示subscribe按钮和订阅按钮\n      subscribed: false,\n      authority: false,\n      logged: localStorage.getItem(\"Logged\"),\n      places: '',\n      renderList: [{}],\n      hotac: true,\n      rateac: true,\n      Pname: localStorage.getItem('Pname'),\n      Pcover: localStorage.getItem('Pcover'),\n      PID: localStorage.getItem('PID'),\n      rander: false,\n      searchContent: \"\",\n      rankList: [{}],\n      rank: ''\n    };\n  }\n\n  sortByHot() {\n    var places = this.state.places;\n\n    if (this.state.hotac) {\n      places.sort(function (a, b) {\n        return -a.hot + b.hot;\n      });\n      this.setState({\n        hotac: false\n      });\n    } else {\n      places.sort(function (a, b) {\n        return a.hot - b.hot;\n      });\n      this.setState({\n        hotac: true\n      });\n    }\n\n    this.setState({\n      rateac: true\n    });\n    console.log(places);\n    this.setState({\n      renderList: places\n    });\n  }\n\n  sortByRate() {\n    var places = this.state.places;\n\n    if (this.state.rateac) {\n      places.sort(function (a, b) {\n        return -a.ave_rate + b.ave_rate;\n      });\n      this.setState({\n        rateac: false\n      });\n    } else {\n      places.sort(function (a, b) {\n        return a.ave_rate - b.ave_rate;\n      });\n      this.setState({\n        rateac: true\n      });\n    }\n\n    this.setState({\n      hotac: true\n    });\n    console.log(places);\n    this.setState({\n      renderList: places\n    });\n  } //申请和订阅在这里\n\n\n  subscribe() {\n    //const url = 'https://juice-quiz.herokuapp.com/api/platform/dosubscribe';\n    const url = 'http://localhost:3001/api/platform/dosubscribe';\n    Axios.post(url, {\n      PID: this.state.PID,\n      UID: localStorage.getItem(\"UID\")\n    }).then(response => {\n      console.log(response);\n      this.setState({\n        subscribed: true\n      });\n    });\n  }\n\n  apply() {\n    this.setState({\n      apply: true\n    });\n  }\n\n  // async get(){\t\n  // \t\t// const url = 'https://juice-quiz.herokuapp.com/api/platform/quizlist';\n  // \t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\n  // \t\t await Axios.get(url, \n  // \t\t  ).then(res=>{return res.data})\n  // \t\t  .then((response) => {\n  //           this.setState({places:response},() => console.log(this.state.places)) \t   \n  // \t\t });\n  // }\n  async get() {\n    this._isMounted = true; // const url = `https://juice-quiz.herokuapp.com/api/platform/quizlist/${this.state.PID}`;\n\n    const url = `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\n    const res = await Axios.get(url).then(res => {\n      return res.data;\n    }).then(result => {\n      if (this._isMounted) {\n        //console.log(result);\n        this.setState({\n          places: result\n        }, () => {\n          console.log(this.state.places);\n        });\n        this.setState({\n          renderList: this.state.places\n        });\n      }\n    });\n  }\n\n  async get_ranklist() {\n    // const url = `https://juice-quiz.herokuapp.com/api/platform/ranklist/${this.state.PID}`;\n    const url = `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\n    const res = await Axios.get(url).then(res => {\n      return res.data;\n    }).then(result => {\n      if (this._isMounted) {\n        console.log(result);\n        this.setState({\n          rank: result\n        }, () => {\n          console.log(this.state.rank);\n        });\n        this.setState({\n          rankList: this.state.rank\n        });\n      }\n    });\n  }\n\n  is_sub() {\n    console.log(\"start\"); // const url = 'https://juice-quiz.herokuapp.com/api/platform/subscribe';\n\n    const url = `http://localhost:3001/api/platform/subscribe`;\n    Axios.post(url, {\n      PID: this.state.PID,\n      UID: localStorage.getItem(\"UID\")\n    }).then(response => {\n      console.log(response.data);\n      console.log(\"end\");\n      this.setState({\n        subscribed: response.data[\"subscribe\"]\n      });\n    });\n  }\n\n  handleChangeSearch(e) {\n    this.setState({\n      searchContent: e.target.value\n    });\n  }\n\n  async search() {\n    if (this.state.searchContent === \"\") {\n      this.get();\n    } else {\n      //\tconst url= `https://juice-quiz.herokuapp.com/api/quiz/${this.state.searchContent}`;\n      const url = `http://localhost:3001/api/quiz/${this.state.searchContent}`;\n      const res = await Axios.get(url, {\n        params: {\n          PID: this.state.PID\n        }\n      }).then(res => {\n        return res.data;\n      }).then(result => {\n        console.log(result);\n        this.setState({\n          places: result\n        }, () => {\n          console.log(this.state.places);\n        });\n        this.setState({\n          renderList: this.state.places\n        });\n      });\n    }\n  }\n\n  render() {\n    const menu = this.state.rankList.map(place => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rankList\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 8\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: '../' + place.pic,\n        className: \"rankIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 6\n        }\n      }), /*#__PURE__*/React.createElement(\"h4\", {\n        class: \"rankName\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 7\n        }\n      }, place.Uname), /*#__PURE__*/React.createElement(\"h4\", {\n        class: \"rankRepo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 7\n        }\n      }, \"reputation:\", place.Rpoint), /*#__PURE__*/React.createElement(\"div\", {\n        class: \"reputationValue\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 7\n        }\n      })));\n    });\n    console.log(this.state.subscribed);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 12\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rankBoard\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"rankBoardTitle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 5\n      }\n    }, \" reputation rank  \"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 5\n      }\n    }, menu)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"searchContent\",\n      required: true,\n      onChange: this.handleChangeSearch.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 4\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"searchButton\",\n      onClick: () => this.search(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 4\n      }\n    }, \"Search \")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"platFormButton\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: './' + this.state.Pcover,\n      className: \"icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"h\", {\n      className: \"platFormName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 13\n      }\n    }, this.state.Pname), !this.state.subscribed && /*#__PURE__*/React.createElement(\"button\", {\n      className: \"platformaccount\",\n      onClick: () => this.subscribe(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 29\n      }\n    }, \"subscribe\") || /*#__PURE__*/React.createElement(\"button\", {\n      className: \"platformaccount\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 117\n      }\n    }, \"subscribed \\u221A\"), !this.state.apply && /*#__PURE__*/React.createElement(\"button\", {\n      className: \"platformaccount\",\n      onClick: () => this.apply(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 24\n      }\n    }, \"Apply to be co-owner\") || /*#__PURE__*/React.createElement(\"button\", {\n      className: \"platformaccount\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 119\n      }\n    }, \"apply has been sent\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"sort\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"sortButton\",\n      onClick: () => this.sortByRate(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 4\n      }\n    }, \"\\u2B50 Rate \"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"sortButton\",\n      onClick: () => this.sortByHot(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 13\n      }\n    }, \"\\uD83D\\uDD25 Hot \")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"platFormlist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 4\n      }\n    }, this.state.rander && this.state.renderList.map(place => {\n      //console.log(this.state.places)\t\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 5\n        }\n      }, place.Qname, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rate\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 6\n        }\n      }, \"\\u2B50: \", place.ave_rate, \" \\uD83D\\uDD25\\uFF1A\", place.hot)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 6\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"discription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 6\n        }\n      }, place.description), /*#__PURE__*/React.createElement(Media, {\n        object: true,\n        src: '../' + place.pic,\n        alt: place.Releaser,\n        className: \"userIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 6\n        }\n      })));\n    }))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/dry19/Documents/GitHub/Juice-Quiz/client/src/singlePlatform/singlePlatForm.js"],"names":["React","Component","Media","Axios","singlePlatForm","constructor","props","_isMounted","componentDidMount","get","get_ranklist","setState","rander","is_sub","state","subscribed","authority","logged","localStorage","getItem","places","renderList","hotac","rateac","Pname","Pcover","PID","searchContent","rankList","rank","sortByHot","sort","a","b","hot","console","log","sortByRate","ave_rate","subscribe","url","post","UID","then","response","apply","res","data","result","handleChangeSearch","e","target","value","search","params","render","menu","map","place","pic","Uname","Rpoint","bind","Qname","description","Releaser"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAO,sBAAP;AACA,SAASC,KAAT,QAAsB,YAAtB;AACA,OAAOC,KAAP,MAAkB,OAAlB,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,MAAMC,cAAN,SAA6BH,SAA7B,CAAuC;AAErDI,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAClB,UAAMA,KAAN;AADkB,SADnBC,UACmB,GADN,KACM;;AAAA,SAwBnBC,iBAxBmB,GAwBD,MAAI;AACtB,WAAKC,GAAL;AACA,WAAKC,YAAL;AACA,WAAKC,QAAL,CAAc;AAACC,QAAAA,MAAM,EAAC;AAAR,OAAd;AACA,WAAKC,MAAL;AAGA,KA/BmB;;AAElB,SAAKC,KAAL,GAAa;AACZ;AACAC,MAAAA,UAAU,EAAC,KAFC;AAGZC,MAAAA,SAAS,EAAC,KAHE;AAIZC,MAAAA,MAAM,EAACC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAJK;AAKZC,MAAAA,MAAM,EAAE,EALI;AAMHC,MAAAA,UAAU,EAAC,CAAC,EAAD,CANR;AAOZC,MAAAA,KAAK,EAAC,IAPM;AAQZC,MAAAA,MAAM,EAAC,IARK;AASZC,MAAAA,KAAK,EAAEN,YAAY,CAACC,OAAb,CAAqB,OAArB,CATK;AAUZM,MAAAA,MAAM,EAACP,YAAY,CAACC,OAAb,CAAqB,QAArB,CAVK;AAWZO,MAAAA,GAAG,EAAER,YAAY,CAACC,OAAb,CAAqB,KAArB,CAXO;AAYZP,MAAAA,MAAM,EAAC,KAZK;AAaZe,MAAAA,aAAa,EAAC,EAbF;AAcZC,MAAAA,QAAQ,EAAC,CAAC,EAAD,CAdG;AAeZC,MAAAA,IAAI,EAAC;AAfO,KAAb;AAkBA;;AAkBDC,EAAAA,SAAS,GAAE;AACV,QAAIV,MAAM,GAAG,KAAKN,KAAL,CAAWM,MAAxB;;AACA,QAAG,KAAKN,KAAL,CAAWQ,KAAd,EAAoB;AACZF,MAAAA,MAAM,CAACW,IAAP,CAAY,UAASC,CAAT,EAAYC,CAAZ,EAAc;AAAC,eAAO,CAACD,CAAC,CAACE,GAAH,GAASD,CAAC,CAACC,GAAlB;AAAsB,OAAjD;AACL,WAAKvB,QAAL,CAAc;AAACW,QAAAA,KAAK,EAAC;AAAP,OAAd;AACF,KAHD,MAII;AACHF,MAAAA,MAAM,CAACW,IAAP,CAAY,UAASC,CAAT,EAAYC,CAAZ,EAAc;AAAC,eAAOD,CAAC,CAACE,GAAF,GAAQD,CAAC,CAACC,GAAjB;AAAqB,OAAhD;AACA,WAAKvB,QAAL,CAAc;AAACW,QAAAA,KAAK,EAAC;AAAP,OAAd;AACA;;AAED,SAAKX,QAAL,CAAc;AAACY,MAAAA,MAAM,EAAC;AAAR,KAAd;AACAY,IAAAA,OAAO,CAACC,GAAR,CAAYhB,MAAZ;AAEA,SAAKT,QAAL,CAAc;AAACU,MAAAA,UAAU,EAAED;AAAb,KAAd;AACA;;AAEDiB,EAAAA,UAAU,GAAE;AACX,QAAIjB,MAAM,GAAG,KAAKN,KAAL,CAAWM,MAAxB;;AACA,QAAG,KAAKN,KAAL,CAAWS,MAAd,EAAqB;AACpBH,MAAAA,MAAM,CAACW,IAAP,CAAY,UAASC,CAAT,EAAYC,CAAZ,EAAc;AAAC,eAAO,CAACD,CAAC,CAACM,QAAH,GAAcL,CAAC,CAACK,QAAvB;AAAgC,OAA3D;AACA,WAAK3B,QAAL,CAAc;AAACY,QAAAA,MAAM,EAAC;AAAR,OAAd;AACE,KAHH,MAIM;AACHH,MAAAA,MAAM,CAACW,IAAP,CAAY,UAASC,CAAT,EAAYC,CAAZ,EAAc;AAAC,eAAOD,CAAC,CAACM,QAAF,GAAaL,CAAC,CAACK,QAAtB;AAA+B,OAA1D;AACA,WAAK3B,QAAL,CAAc;AAACY,QAAAA,MAAM,EAAC;AAAR,OAAd;AACA;;AACD,SAAKZ,QAAL,CAAc;AAACW,MAAAA,KAAK,EAAC;AAAP,KAAd;AACFa,IAAAA,OAAO,CAACC,GAAR,CAAYhB,MAAZ;AACA,SAAKT,QAAL,CAAc;AAACU,MAAAA,UAAU,EAAED;AAAb,KAAd;AAEA,GAvEoD,CA8ErD;;;AACAmB,EAAAA,SAAS,GAAE;AAER;AACA,UAAMC,GAAG,GAAE,gDAAX;AAEArC,IAAAA,KAAK,CAACsC,IAAN,CAAWD,GAAX,EAAgB;AACjBd,MAAAA,GAAG,EAAG,KAAKZ,KAAL,CAAWY,GADA;AAEjBgB,MAAAA,GAAG,EAAExB,YAAY,CAACC,OAAb,CAAqB,KAArB;AAFY,KAAhB,EAGGwB,IAHH,CAGSC,QAAD,IAAc;AACtBT,MAAAA,OAAO,CAACC,GAAR,CAAYQ,QAAZ;AACA,WAAKjC,QAAL,CAAc;AAACI,QAAAA,UAAU,EAAC;AAAZ,OAAd;AACC,KAND;AAUF;;AAGD8B,EAAAA,KAAK,GAAE;AACN,SAAKlC,QAAL,CAAc;AAACkC,MAAAA,KAAK,EAAC;AAAP,KAAd;AACA;;AAED;AACA;AACA;AACA;AACA;AACA;AACG;AACH;AAGA;AAES,QAAHpC,GAAG,GAAE;AACV,SAAKF,UAAL,GAAkB,IAAlB,CADU,CAEL;;AACJ,UAAMiC,GAAG,GAAG,+CAA8C,KAAK1B,KAAL,CAAWY,GAAI,EAAzE;AACG,UAAMoB,GAAG,GAAG,MAAM3C,KAAK,CAACM,GAAN,CAAU+B,GAAV,EACjBG,IADiB,CACZG,GAAG,IAAE;AAAC,aAAOA,GAAG,CAACC,IAAX;AAAgB,KADV,EAEjBJ,IAFiB,CAEXK,MAAM,IAAG;AAClB,UAAG,KAAKzC,UAAR,EAAmB;AACnB;AACM,aAAKI,QAAL,CAAc;AAACS,UAAAA,MAAM,EAAC4B;AAAR,SAAd,EAA8B,MAAI;AAACb,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKtB,KAAL,CAAWM,MAAvB;AAAgC,SAAnE;AACA,aAAKT,QAAL,CAAc;AAACU,UAAAA,UAAU,EAAC,KAAKP,KAAL,CAAWM;AAAvB,SAAd;AAA+C;AACjD,KAPgB,CAAlB;AAQD;;AAGiB,QAAZV,YAAY,GAAE;AACtB;AACA,UAAM8B,GAAG,GAAG,+CAA8C,KAAK1B,KAAL,CAAWY,GAAI,EAAzE;AACA,UAAMoB,GAAG,GAAG,MAAM3C,KAAK,CAACM,GAAN,CAAU+B,GAAV,EACjBG,IADiB,CACZG,GAAG,IAAE;AAAC,aAAOA,GAAG,CAACC,IAAX;AAAgB,KADV,EAEjBJ,IAFiB,CAEXK,MAAM,IAAG;AACf,UAAG,KAAKzC,UAAR,EAAmB;AACnB4B,QAAAA,OAAO,CAACC,GAAR,CAAYY,MAAZ;AACA,aAAKrC,QAAL,CAAc;AAACkB,UAAAA,IAAI,EAACmB;AAAN,SAAd,EAA4B,MAAI;AAACb,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKtB,KAAL,CAAWe,IAAvB;AAA8B,SAA/D;AACA,aAAKlB,QAAL,CAAc;AAACiB,UAAAA,QAAQ,EAAC,KAAKd,KAAL,CAAWe;AAArB,SAAd;AAA2C;AAC1C,KAPgB,CAAlB;AAQA;;AAIAhB,EAAAA,MAAM,GAAE;AACPsB,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EADO,CAED;;AACN,UAAMI,GAAG,GAAG,8CAAZ;AACMrC,IAAAA,KAAK,CAACsC,IAAN,CAAWD,GAAX,EAAgB;AACtBd,MAAAA,GAAG,EAAG,KAAKZ,KAAL,CAAWY,GADK;AAEtBgB,MAAAA,GAAG,EAAExB,YAAY,CAACC,OAAb,CAAqB,KAArB;AAFiB,KAAhB,EAGFwB,IAHE,CAGIC,QAAD,IAAc;AACvBT,MAAAA,OAAO,CAACC,GAAR,CAAYQ,QAAQ,CAACG,IAArB;AACAZ,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA,WAAKzB,QAAL,CAAc;AAACI,QAAAA,UAAU,EAAE6B,QAAQ,CAACG,IAAT,CAAc,WAAd;AAAb,OAAd;AACE,KAPI;AAQP;;AAGDE,EAAAA,kBAAkB,CAACC,CAAD,EAAI;AACrB,SAAKvC,QAAL,CAAc;AAACgB,MAAAA,aAAa,EAAEuB,CAAC,CAACC,MAAF,CAASC;AAAzB,KAAd;AACA;;AAEW,QAANC,MAAM,GAAE;AACb,QAAI,KAAKvC,KAAL,CAAWa,aAAX,KAA2B,EAA/B,EAAkC;AACjC,WAAKlB,GAAL;AACA,KAFD,MAEK;AACL;AACA,YAAM+B,GAAG,GAAG,kCAAiC,KAAK1B,KAAL,CAAWa,aAAc,EAAtE;AACE,YAAMmB,GAAG,GAAG,MAAM3C,KAAK,CAACM,GAAN,CAAU+B,GAAV,EAAc;AACjCc,QAAAA,MAAM,EAAE;AACN5B,UAAAA,GAAG,EAAE,KAAKZ,KAAL,CAAWY;AADV;AADyB,OAAd,EAKjBiB,IALiB,CAKZG,GAAG,IAAE;AAAC,eAAOA,GAAG,CAACC,IAAX;AAAgB,OALV,EAMjBJ,IANiB,CAMXK,MAAM,IAAG;AAEfb,QAAAA,OAAO,CAACC,GAAR,CAAYY,MAAZ;AACA,aAAKrC,QAAL,CAAc;AAACS,UAAAA,MAAM,EAAC4B;AAAR,SAAd,EAA8B,MAAI;AAACb,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKtB,KAAL,CAAWM,MAAvB;AAAgC,SAAnE;AACA,aAAKT,QAAL,CAAc;AAACU,UAAAA,UAAU,EAAC,KAAKP,KAAL,CAAWM;AAAvB,SAAd;AACC,OAXgB,CAAlB;AAaD;AAEA;;AAMFmC,EAAAA,MAAM,GAAG;AACR,UAAMC,IAAI,GAAG,KAAK1C,KAAL,CAAWc,QAAX,CAAoB6B,GAApB,CAAyBC,KAAD,IAAW;AAC/C,0BAEI;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACA;AAAK,QAAA,GAAG,EAAE,QAAMA,KAAK,CAACC,GAAtB;AAA2B,QAAA,SAAS,EAAC,UAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,eAGC;AAAI,QAAA,KAAK,EAAC,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAsBD,KAAK,CAACE,KAA5B,CAHD,eAIC;AAAI,QAAA,KAAK,EAAC,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAiCF,KAAK,CAACG,MAAvC,CAJD,eAMC;AAAK,QAAA,KAAK,EAAC,iBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAND,CAFE,CAFJ;AAkBA,KAnBY,CAAb;AAoBA1B,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKtB,KAAL,CAAWC,UAAvB;AACA,wBACS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEP;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADA,eAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAMyC,IAAN,CAFA,CAFO,eAMC;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAND,eAQR;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAO,MAAA,SAAS,EAAC,eAAjB;AAAiC,MAAA,QAAQ,MAAzC;AAA0C,MAAA,QAAQ,EAAE,KAAKP,kBAAL,CAAwBa,IAAxB,CAA6B,IAA7B,CAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,eAEA;AAAQ,MAAA,SAAS,EAAC,cAAlB;AAAgC,MAAA,OAAO,EAAE,MAAI,KAAKT,MAAL,EAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAFA,CARQ,eAaR;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEa;AAAK,MAAA,GAAG,EAAG,OAAK,KAAKvC,KAAL,CAAWW,MAA3B;AAAoC,MAAA,SAAS,EAAC,MAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFb,eAGS;AAAG,MAAA,SAAS,EAAC,cAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA6B,KAAKX,KAAL,CAAWU,KAAxC,CAHT,EAIC,CAAC,KAAKV,KAAL,CAAWC,UAAZ,iBAAwB;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAqC,MAAA,OAAO,EAAE,MAAI,KAAKwB,SAAL,EAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAxB,iBAAgH;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAJjH,EAKC,CAAC,KAAKzB,KAAL,CAAW+B,KAAZ,iBAAmB;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAqC,MAAA,OAAO,EAAE,MAAI,KAAKA,KAAL,EAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BAAnB,iBAAkH;AAAQ,MAAA,SAAS,EAAC,iBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BALnH,CAbQ,eAsBR;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAGA;AAAQ,MAAA,SAAS,EAAC,YAAlB;AAA8B,MAAA,OAAO,EAAE,MAAI,KAAKR,UAAL,EAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAHA,eAIS;AAAQ,MAAA,SAAS,EAAC,YAAlB;AAA+B,MAAA,OAAO,EAAE,MAAI,KAAKP,SAAL,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAJT,CAtBQ,eA6BR;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC,KAAKhB,KAAL,CAAWF,MAAX,IAAmB,KAAKE,KAAL,CAAWO,UAAX,CAAsBoC,GAAtB,CAA2BC,KAAD,IAAW;AAC1D;AACA,0BAEC;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACC;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACEA,KAAK,CAACK,KADR,eAEC;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAA0BL,KAAK,CAACpB,QAAhC,yBAA8CoB,KAAK,CAACxB,GAApD,CAFD,CADD,eAKE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACA;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA8BwB,KAAK,CAACM,WAApC,CADA,eAEA,oBAAC,KAAD;AAAO,QAAA,MAAM,MAAb;AAAc,QAAA,GAAG,EAAE,QAAMN,KAAK,CAACC,GAA/B;AAAoC,QAAA,GAAG,EAAED,KAAK,CAACO,QAA/C;AAAyD,QAAA,SAAS,EAAC,UAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFA,CALF,CAFD;AAcA,KAhBqB,CADpB,CADA,CA7BQ,CADT;AA4DA;;AA/QoD","sourcesContent":["import React from 'react';\r\nimport { Component } from 'react';  \r\nimport './singlePlatForm.css'\r\nimport { Media } from 'reactstrap';\r\nimport Axios from \"axios\";\r\n\r\n// const places = \r\n// \t[\r\n// \t\t{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user1',\r\n// \t\t\timage: './account.jpg', \r\n// \t\t\treputation:2\r\n\t\t\t \r\n// \t\t} ,\r\n// \t\t{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user3',\r\n// \t\t\timage: './popMusic.jpg',\r\n// \t\t\treputation:2\r\n// \t\t} ,{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user2',\r\n// \t\t\timage: './classicMusic.jpg',\r\n// \t\t\treputation:2\r\n// \t\t}  \t];\r\n\r\nexport default class singlePlatForm extends Component {\r\n\t_isMounted = false;\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\t//决定是否显示subscribe按钮和订阅按钮\r\n\t\t\tsubscribed:false,\r\n\t\t\tauthority:false,\r\n\t\t\tlogged:localStorage.getItem(\"Logged\"),\r\n\t\t\tplaces: '',\r\n            renderList:[{}],\r\n\t\t\thotac:true,\r\n\t\t\trateac:true,\r\n\t\t\tPname :localStorage.getItem('Pname'),\r\n\t\t\tPcover:localStorage.getItem('Pcover'),\r\n\t\t\tPID: localStorage.getItem('PID'),\r\n\t\t\trander:false,\r\n\t\t\tsearchContent:\"\",\r\n\t\t\trankList:[{}],\r\n\t\t\trank:''\r\n\t\t};\r\n        \r\n\t}\r\n    \r\n\r\n\t\r\n componentDidMount=()=>{\r\n\tthis.get() ;\r\n\tthis.get_ranklist();\r\n\tthis.setState({rander:true});\r\n\tthis.is_sub();\r\n\t\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tsortByHot(){ \r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.hotac){\r\n          places.sort(function(a, b){return -a.hot + b.hot});\r\n\t\t   this.setState({hotac:false});\r\n\t\t}\r\n\t\telse{\r\n\t\t places.sort(function(a, b){return a.hot - b.hot}); \r\n\t\t this.setState({hotac:true});\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState({rateac:true})\r\n\t\tconsole.log(places)\r\n\t\t\r\n\t\tthis.setState({renderList: places })\r\n\t}\r\n\t\r\n\tsortByRate(){\r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.rateac){\r\n\t\t\tplaces.sort(function(a, b){return -a.ave_rate + b.ave_rate}); \r\n\t\t\tthis.setState({rateac:false})\r\n\t\t  }\r\n\t\t  else{\r\n\t\t   places.sort(function(a, b){return a.ave_rate - b.ave_rate}); \r\n\t\t   this.setState({rateac:true})\r\n\t\t  }\r\n\t\t  this.setState({hotac:true})\r\n\t\tconsole.log(places)\r\n\t\tthis.setState({renderList: places })\r\n\r\n\t}\r\n \r\n\r\n\r\n\r\n\r\n\r\n\t//申请和订阅在这里\r\n\tsubscribe(){\r\n\r\n\t   //const url = 'https://juice-quiz.herokuapp.com/api/platform/dosubscribe';\r\n\t   const url= 'http://localhost:3001/api/platform/dosubscribe';\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({subscribed:true})\r\n\t\t  }); \r\n\t \r\n\t\t\r\n\r\n\t}\r\n\r\n\r\n\tapply(){\r\n\t\tthis.setState({apply:true})\r\n\t};\r\n    \r\n\t// async get(){\t\r\n\t// \t\t// const url = 'https://juice-quiz.herokuapp.com/api/platform/quizlist';\r\n\t// \t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\r\n\t// \t\t await Axios.get(url, \r\n\t// \t\t  ).then(res=>{return res.data})\r\n\t// \t\t  .then((response) => {\r\n    //           this.setState({places:response},() => console.log(this.state.places)) \t   \r\n\t// \t\t });\r\n\t\t\t \r\n\t\t\t\t\t   \r\n\t// }\r\n\t\r\n\tasync get(){\r\n\t\tthis._isMounted = true;\r\n       // const url = `https://juice-quiz.herokuapp.com/api/platform/quizlist/${this.state.PID}`;\r\n\t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\r\n      const res = await Axios.get(url)\r\n      .then(res=>{return res.data})\r\n      .then( result =>{\r\n\t\t  if(this._isMounted){\r\n\t\t  //console.log(result);\r\n          this.setState({places:result},()=>{console.log(this.state.places);});\r\n          this.setState({renderList:this.state.places});}          \r\n       });\r\n    }\r\n    \r\n\r\n    async get_ranklist(){\r\n\t\t// const url = `https://juice-quiz.herokuapp.com/api/platform/ranklist/${this.state.PID}`;\r\n\t\tconst url= `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\r\n\t\tconst res = await Axios.get(url)\r\n\t\t.then(res=>{return res.data})\r\n\t\t.then( result =>{\r\n\t\t\tif(this._isMounted){\r\n\t\t\tconsole.log(result);\r\n\t\t\tthis.setState({rank:result},()=>{console.log(this.state.rank);});\r\n\t\t\tthis.setState({rankList:this.state.rank});}          \r\n\t\t });\r\n\t}\r\n\r\n\r\n\r\n\t is_sub(){\r\n\t\t console.log(\"start\")\r\n         // const url = 'https://juice-quiz.herokuapp.com/api/platform/subscribe';\r\n\t\t const url= `http://localhost:3001/api/platform/subscribe`;\r\n         Axios.post(url, {\r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => {\r\n\t\t\tconsole.log(response.data);\r\n\t\t\tconsole.log(\"end\")\r\n\t\t\tthis.setState({subscribed: response.data[\"subscribe\"]})\r\n\t\t  });\r\n\t}\r\n   \r\n\r\n\thandleChangeSearch(e) {  \r\n\t\tthis.setState({searchContent: e.target.value});   \r\n\t} \r\n\r\n\tasync search(){\r\n\t\tif (this.state.searchContent===\"\"){\r\n\t\t\tthis.get();\r\n\t\t}else{\r\n\t\t//\tconst url= `https://juice-quiz.herokuapp.com/api/quiz/${this.state.searchContent}`;\r\n\t\tconst url= `http://localhost:3001/api/quiz/${this.state.searchContent}`;\r\n\t\t  const res = await Axios.get(url,{\r\n\t\t\tparams: {\r\n\t\t\t  PID: this.state.PID\t\t\t  \r\n\t\t\t}\r\n\t\t  })\r\n\t\t  .then(res=>{return res.data})\r\n\t\t  .then( result =>{\r\n\t\t\t\r\n\t\t\t  console.log(result);\r\n\t\t\t  this.setState({places:result},()=>{console.log(this.state.places);});\r\n\t\t\t  this.setState({renderList:this.state.places});        \r\n\t\t   });\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\trender() {     \r\n\t\tconst menu = this.state.rankList.map((place) => {\r\n\t\t\treturn(\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t<div className=\"rankList\">   \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<div> \r\n\t\t\t\t\t<img src={'../'+place.pic} className=\"rankIcon\" />\r\n\t\t\t\t \r\n\t\t\t\t\t\t<h4 class=\"rankName\">{place.Uname}</h4> \r\n\t\t\t\t\t\t<h4 class=\"rankRepo\">reputation:{place.Rpoint}{}</h4> \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"reputationValue\"> \r\n\t\t\t\t\t\t \r\n\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t \r\n\t\t\t\t</div>\r\n\t\t\t   \r\n\t\t\t);\r\n\t\t});\r\n\t\tconsole.log(this.state.subscribed);\r\n\t\treturn (\r\n           <div>\r\n\t\t\t\t \r\n\t\t\t\t<div className=\"rankBoard\"> \r\n\t\t\t\t<div className=\"rankBoardTitle\"> reputation rank  </div>\r\n\t\t\t\t<div>{menu}</div>\r\n\t\t\t\t</div> \r\n            <div className=\"header\"> \r\n\t\t\t</div> \r\n\t\t\t<div className=\"search\"> \r\n\t\t\t<input className='searchContent' required onChange={this.handleChangeSearch.bind(this)}></input>\r\n\t\t\t<button className='searchButton'onClick={()=>this.search()}>Search </button>\r\n\t\t\t</div>   \r\n            \r\n\t\t\t<div className=\"platFormButton\">\r\n\t\t\t\t{/* 此处读取平台的图片！ */}\r\n                <img src= {'./'+this.state.Pcover}  className='icon'></img> \r\n            <h className='platFormName'>{this.state.Pname}</h>\r\n\t\t\t{!this.state.subscribed&&<button className='platformaccount'  onClick={()=>this.subscribe()}>subscribe</button>||<button className='platformaccount' >subscribed √</button>}\r\n\t\t\t{!this.state.apply&&<button className='platformaccount'  onClick={()=>this.apply()}>Apply to be co-owner</button>||<button className='platformaccount' >apply has been sent</button>}\r\n          \r\n\t\t     \r\n            </div>\r\n\t\t\t<div className=\"sort\">\r\n\r\n\t\t\t\r\n\t\t\t<button className='sortButton'onClick={()=>this.sortByRate()}>⭐ Rate </button>\r\n            <button className='sortButton' onClick={()=>this.sortByHot()}>🔥 Hot </button>\r\n\t\t\t</div>\r\n \r\n\t\t\t<div className='platFormlist'> \r\n\t\t\t<div>\r\n\t\t\t{this.state.rander&&this.state.renderList.map((place) => {\r\n\t\t//console.log(this.state.places)\t\r\n\t\treturn(\r\n\t\t \r\n\t\t\t<div className=\"item\">  \r\n\t\t\t <div className='title'>\r\n\t\t\t\t {place.Qname} \r\n\t\t\t\t <div className='rate'>⭐: {place.ave_rate} 🔥：{place.hot}</div> \r\n\t\t\t </div >\r\n\t\t\t \t<div className='content'> \r\n\t\t\t\t <div className='discription'>{place.description}</div>\r\n\t\t\t \t<Media object src={'../'+place.pic} alt={place.Releaser} className='userIcon'/> \r\n\t\t\t\t </div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t);\r\n\t})}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t</div>\r\n\t\t\t </div>\r\n\t\t</div>\r\n\t\t)\r\n\t}\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}