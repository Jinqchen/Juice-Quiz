{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Component}from'react';import'./singlePlatForm.css';import{Media}from'reactstrap';import Axios from\"axios\";import{Link}from'react-router-dom';var singlePlatForm=/*#__PURE__*/function(_Component){_inherits(singlePlatForm,_Component);var _super=_createSuper(singlePlatForm);function singlePlatForm(props){var _this;_classCallCheck(this,singlePlatForm);_this=_super.call(this,props);_this._isMounted=false;_this.componentDidMount=function(){_this.get();_this.get_ranklist();_this.setState({rander:true});_this.is_sub();_this.is_coowner();_this.is_owner();_this.get_replimit();};_this.store=function(place){localStorage.setItem('QID',place.QID);};_this.state={//决定是否显示subscribe按钮和订阅按钮\nsubscribed:false,co_owner:false,owner:false,authority:false,logged:localStorage.getItem(\"Logged\"),places:'',renderList:[{}],hotac:true,rateac:true,Pname:localStorage.getItem('Pname'),Pcover:localStorage.getItem('Pcover'),PID:localStorage.getItem('PID'),rander:false,searchContent:\"\",rankList:[{}],rank:'',replimit:0,Urep:0};return _this;}_createClass(singlePlatForm,[{key:\"sortByHot\",value:// Sort function \nfunction sortByHot(){var places=this.state.places;if(this.state.hotac){places.sort(function(a,b){return-a.hot+b.hot;});this.setState({hotac:false});}else{places.sort(function(a,b){return a.hot-b.hot;});this.setState({hotac:true});}this.setState({rateac:true});console.log(places);this.setState({renderList:places});}},{key:\"sortByRate\",value:function sortByRate(){var places=this.state.places;if(this.state.rateac){places.sort(function(a,b){return-a.ave_rate+b.ave_rate;});this.setState({rateac:false});}else{places.sort(function(a,b){return a.ave_rate-b.ave_rate;});this.setState({rateac:true});}this.setState({hotac:true});console.log(places);this.setState({renderList:places});}//申请和订阅在这里\n},{key:\"subscribe\",value:function subscribe(){var _this2=this;var url='https://juice-quiz.herokuapp.com/api/platform/dosubscribe';//   const url= 'http://localhost:3001/api/platform/dosubscribe';\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response);_this2.setState({subscribed:true});});this.inital_reputation();}},{key:\"unsubscribe\",value:function unsubscribe(){if(this.state.owner){alert(\"You can't unsubscribe your own platform!\");}else if(this.state.co_owner){console.log(\"co\");this.op_unsub();this.op_uncoown();}else{this.op_unsub();}}},{key:\"op_unsub\",value:function op_unsub(){var url=\"https://juice-quiz.herokuapp.com/api/platform/delSub/\".concat(this.state.PID);//const url= `http://localhost:3001/api/platform/delSub/${this.state.PID}`;\nAxios.delete(url,{data:{UID:localStorage.getItem(\"UID\")}}).then(function(response){console.log(response);});this.setState({subscribed:false});}},{key:\"op_uncoown\",value:function op_uncoown(){var url=\"https://juice-quiz.herokuapp.com/api/platform/delCoown/\".concat(this.state.PID);//const url= `http://localhost:3001/api/platform/delCoown/${this.state.PID}`;\nAxios.delete(url,{data:{UID:localStorage.getItem(\"UID\")}}).then(function(response){console.log(response);});this.setState({co_owner:false});}},{key:\"inital_reputation\",value:function inital_reputation(){var _this3=this;var url='https://juice-quiz.herokuapp.com/api/platform/initalR';//const url= 'http://localhost:3001/api/platform/initalR';\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response);_this3.setState({subscribed:true});});}// Apply function \n},{key:\"do_apply\",value:function do_apply(){var _this4=this;var url=\"https://juice-quiz.herokuapp.com/api/platform/doapply\";//const url= `http://localhost:3001/api/platform/doapply`;\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response);_this4.setState({co_owner:true});});}},{key:\"apply\",value:function apply(){if(!this.state.subscribed){alert(\"You need to subscribe the platform first!\");}else{this.get_Urep();if(this.state.Urep<this.state.replimit){alert(\"You didn't reach the co-owner requirment\");}else{this.do_apply();}}}},{key:\"get_replimit\",value:function get_replimit(){var _this5=this;var url=\"https://juice-quiz.herokuapp.com/api/platform/\".concat(this.state.PID,\"/replimit\");//  const url= `http://localhost:3001/api/platform/${this.state.PID}/replimit`;\nAxios.get(url).then(function(res){return res.data;}).then(function(response){_this5.setState({replimit:response[0]['replimit']});console.log(_this5.state.replimit);});}},{key:\"get_Urep\",value:function get_Urep(){var _this6=this;var url=\"https://juice-quiz.herokuapp.com/api/platform/userRep/\".concat(localStorage.getItem(\"UID\"));//const url= `http://localhost:3001/api/platform/userRep/${localStorage.getItem(\"UID\")}`;\nAxios.get(url,{params:{PID:this.state.PID}}).then(function(res){return res.data;}).then(function(response){_this6.setState({Urep:response[0]['Rpoint']});});}},{key:\"get\",value:function(){var _get=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this7=this;var url,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this._isMounted=true;//  const url = `https://juice-quiz.herokuapp.com/api/platform/quizlist/${this.state.PID}`;\nurl=\"http://localhost:3001/api/platform/quizlist/\".concat(this.state.PID);_context.next=4;return Axios.get(url).then(function(res){return res.data;}).then(function(result){if(_this7._isMounted){//console.log(result);\n_this7.setState({places:result},function(){console.log(_this7.state.places);});_this7.setState({renderList:_this7.state.places});}});case 4:res=_context.sent;case 5:case\"end\":return _context.stop();}}},_callee,this);}));function get(){return _get.apply(this,arguments);}return get;}()},{key:\"get_ranklist\",value:function(){var _get_ranklist=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this8=this;var url,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:url=\"https://juice-quiz.herokuapp.com/api/platform/ranklist/\".concat(this.state.PID);//\tconst url= `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\n_context2.next=3;return Axios.get(url).then(function(res){return res.data;}).then(function(result){if(_this8._isMounted){console.log(result);_this8.setState({rank:result},function(){console.log(_this8.state.rank);});_this8.setState({rankList:_this8.state.rank});}});case 3:res=_context2.sent;case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function get_ranklist(){return _get_ranklist.apply(this,arguments);}return get_ranklist;}()},{key:\"is_sub\",value:function is_sub(){var _this9=this;var url='https://juice-quiz.herokuapp.com/api/platform/subscribe';//\t const url= `http://localhost:3001/api/platform/subscribe`;\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response.data);_this9.setState({subscribed:response.data[\"subscribe\"]});});}},{key:\"is_coowner\",value:function is_coowner(){var _this10=this;console.log(\"start\");var url='https://juice-quiz.herokuapp.com/api/platform/coowner';//const url= `http://localhost:3001/api/platform/coowner`;\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response.data);_this10.setState({co_owner:response.data[\"coowner\"]});});}},{key:\"is_owner\",value:function is_owner(){var _this11=this;console.log(\"start\");var url='https://juice-quiz.herokuapp.com/api/platform/owner';//const url= `http://localhost:3001/api/platform/owner`;\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response.data);_this11.setState({owner:response.data[\"owner\"]});});}},{key:\"handleChangeSearch\",value://Search \nfunction handleChangeSearch(e){this.setState({searchContent:e.target.value});}},{key:\"search\",value:function(){var _search=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this12=this;var url,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this.state.searchContent===\"\")){_context3.next=4;break;}this.get();_context3.next=8;break;case 4:url=\"https://juice-quiz.herokuapp.com/api/quiz/\".concat(this.state.searchContent);//const url= `http://localhost:3001/api/quiz/${this.state.searchContent}`;\n_context3.next=7;return Axios.get(url,{params:{PID:this.state.PID}}).then(function(res){return res.data;}).then(function(result){console.log(result);_this12.setState({places:result},function(){console.log(_this12.state.places);});_this12.setState({renderList:_this12.state.places});});case 7:res=_context3.sent;case 8:case\"end\":return _context3.stop();}}},_callee3,this);}));function search(){return _search.apply(this,arguments);}return search;}()},{key:\"render\",value:function render(){var _this13=this;var menu=this.state.rankList.map(function(place){return/*#__PURE__*/React.createElement(\"div\",{className:\"rankList\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{src:'../'+place.pic,className:\"rankIcon\"}),/*#__PURE__*/React.createElement(\"h4\",{class:\"rankName\"},place.Uname),/*#__PURE__*/React.createElement(\"h4\",{class:\"rankRepo\"},\"reputation:\",place.Rpoint),/*#__PURE__*/React.createElement(\"div\",{class:\"reputationValue\"})));});console.log(this.state.subscribed);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"rankBoard\"},/*#__PURE__*/React.createElement(\"div\",{className:\"rankBoardTitle\"},\" reputation rank  \"),/*#__PURE__*/React.createElement(\"div\",null,menu)),/*#__PURE__*/React.createElement(\"div\",{className:\"header\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"search\"},/*#__PURE__*/React.createElement(\"input\",{className:\"searchContent\",required:true,onChange:this.handleChangeSearch.bind(this)}),/*#__PURE__*/React.createElement(\"button\",{className:\"searchButton\",onClick:function onClick(){return _this13.search();}},\"Search \")),/*#__PURE__*/React.createElement(\"div\",{className:\"platFormButton\"},/*#__PURE__*/React.createElement(\"img\",{src:'../'+this.state.Pcover,className:\"icon\"}),/*#__PURE__*/React.createElement(\"h\",{className:\"platFormName\"},this.state.Pname),!this.state.subscribed&&/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\",onClick:function onClick(){return _this13.subscribe();}},\"subscribe\")||/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\",onClick:function onClick(){return _this13.unsubscribe();}},\"subscribed \\u221A\"),!this.state.co_owner&&/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\",onClick:function onClick(){return _this13.apply();}},\"Apply to be co-owner\")||/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\"},\"Co-Owner\")),/*#__PURE__*/React.createElement(\"div\",{className:\"sort\"},/*#__PURE__*/React.createElement(\"button\",{className:\"sortButton\",onClick:function onClick(){return _this13.sortByRate();}},\"\\u2B50 Rate \"),/*#__PURE__*/React.createElement(\"button\",{className:\"sortButton\",onClick:function onClick(){return _this13.sortByHot();}},\"\\uD83D\\uDD25 Hot \")),/*#__PURE__*/React.createElement(\"div\",{className:\"platFormlist\"},/*#__PURE__*/React.createElement(\"div\",null,this.state.rander&&this.state.renderList.map(function(place){//console.log(this.state.places)\t\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},/*#__PURE__*/React.createElement(Link,{to:\"/platform/\"+_this13.state.PID+\"/answer/\"+place.QID,onClick:function onClick(){return _this13.store(place);}},\" \",place.Qname,\" \"),/*#__PURE__*/React.createElement(\"div\",{className:\"rate\"},\"\\u2B50: \",place.ave_rate,\" \\uD83D\\uDD25\\uFF1A\",place.hot)),/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"discription\"},place.description),/*#__PURE__*/React.createElement(Media,{object:true,src:'../'+place.pic,alt:place.Releaser,className:\"userIcon\"})));}))));}}]);return singlePlatForm;}(Component);export{singlePlatForm as default};","map":{"version":3,"sources":["C:/Users/dry19/Documents/GitHub/Juice-Quiz/client/src/singlePlatform/singlePlatForm.js"],"names":["React","Component","Media","Axios","Link","singlePlatForm","props","_isMounted","componentDidMount","get","get_ranklist","setState","rander","is_sub","is_coowner","is_owner","get_replimit","store","place","localStorage","setItem","QID","state","subscribed","co_owner","owner","authority","logged","getItem","places","renderList","hotac","rateac","Pname","Pcover","PID","searchContent","rankList","rank","replimit","Urep","sort","a","b","hot","console","log","ave_rate","url","post","UID","then","response","inital_reputation","alert","op_unsub","op_uncoown","delete","data","get_Urep","do_apply","res","params","result","e","target","value","menu","map","pic","Uname","Rpoint","handleChangeSearch","bind","search","subscribe","unsubscribe","apply","sortByRate","sortByHot","Qname","description","Releaser"],"mappings":"+hCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,MAAO,sBAAP,CACA,OAASC,KAAT,KAAsB,YAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,KAAqB,kBAArB,C,GAEqBC,CAAAA,c,gHAEpB,wBAAYC,KAAZ,CAAmB,gDAClB,uBAAMA,KAAN,EADkB,MADnBC,UACmB,CADN,KACM,OA4BnBC,iBA5BmB,CA4BD,UAAI,CACtB,MAAKC,GAAL,GACA,MAAKC,YAAL,GACA,MAAKC,QAAL,CAAc,CAACC,MAAM,CAAC,IAAR,CAAd,EACA,MAAKC,MAAL,GACA,MAAKC,UAAL,GACA,MAAKC,QAAL,GACA,MAAKC,YAAL,GACA,CApCmB,OAgTpBC,KAhToB,CAgTd,SAACC,KAAD,CAAS,CACdC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAA2BF,KAAK,CAACG,GAAjC,EAEA,CAnTmB,CAElB,MAAKC,KAAL,CAAa,CACZ;AACAC,UAAU,CAAC,KAFC,CAGZC,QAAQ,CAAC,KAHG,CAIZC,KAAK,CAAC,KAJM,CAKZC,SAAS,CAAC,KALE,CAMZC,MAAM,CAACR,YAAY,CAACS,OAAb,CAAqB,QAArB,CANK,CAOZC,MAAM,CAAE,EAPI,CAQHC,UAAU,CAAC,CAAC,EAAD,CARR,CASZC,KAAK,CAAC,IATM,CAUZC,MAAM,CAAC,IAVK,CAWZC,KAAK,CAAEd,YAAY,CAACS,OAAb,CAAqB,OAArB,CAXK,CAYZM,MAAM,CAACf,YAAY,CAACS,OAAb,CAAqB,QAArB,CAZK,CAaZO,GAAG,CAAEhB,YAAY,CAACS,OAAb,CAAqB,KAArB,CAbO,CAcZhB,MAAM,CAAC,KAdK,CAeZwB,aAAa,CAAC,EAfF,CAgBZC,QAAQ,CAAC,CAAC,EAAD,CAhBG,CAiBZC,IAAI,CAAC,EAjBO,CAkBZC,QAAQ,CAAC,CAlBG,CAmBZC,IAAI,CAAC,CAnBO,CAAb,CAFkB,aAwBlB,C,oDAkBF;AACC,oBAAW,CACV,GAAIX,CAAAA,MAAM,CAAG,KAAKP,KAAL,CAAWO,MAAxB,CACA,GAAG,KAAKP,KAAL,CAAWS,KAAd,CAAoB,CACZF,MAAM,CAACY,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAO,CAACD,CAAC,CAACE,GAAH,CAASD,CAAC,CAACC,GAAlB,CAAsB,CAAjD,EACL,KAAKjC,QAAL,CAAc,CAACoB,KAAK,CAAC,KAAP,CAAd,EACF,CAHD,IAII,CACHF,MAAM,CAACY,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAOD,CAAAA,CAAC,CAACE,GAAF,CAAQD,CAAC,CAACC,GAAjB,CAAqB,CAAhD,EACA,KAAKjC,QAAL,CAAc,CAACoB,KAAK,CAAC,IAAP,CAAd,EACA,CAED,KAAKpB,QAAL,CAAc,CAACqB,MAAM,CAAC,IAAR,CAAd,EACAa,OAAO,CAACC,GAAR,CAAYjB,MAAZ,EAEA,KAAKlB,QAAL,CAAc,CAACmB,UAAU,CAAED,MAAb,CAAd,EACA,C,0BAED,qBAAY,CACX,GAAIA,CAAAA,MAAM,CAAG,KAAKP,KAAL,CAAWO,MAAxB,CACA,GAAG,KAAKP,KAAL,CAAWU,MAAd,CAAqB,CACpBH,MAAM,CAACY,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAO,CAACD,CAAC,CAACK,QAAH,CAAcJ,CAAC,CAACI,QAAvB,CAAgC,CAA3D,EACA,KAAKpC,QAAL,CAAc,CAACqB,MAAM,CAAC,KAAR,CAAd,EACE,CAHH,IAIM,CACHH,MAAM,CAACY,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAOD,CAAAA,CAAC,CAACK,QAAF,CAAaJ,CAAC,CAACI,QAAtB,CAA+B,CAA1D,EACA,KAAKpC,QAAL,CAAc,CAACqB,MAAM,CAAC,IAAR,CAAd,EACA,CACD,KAAKrB,QAAL,CAAc,CAACoB,KAAK,CAAC,IAAP,CAAd,EACFc,OAAO,CAACC,GAAR,CAAYjB,MAAZ,EACA,KAAKlB,QAAL,CAAc,CAACmB,UAAU,CAAED,MAAb,CAAd,EAEA,CAID;yBACA,oBAAW,iBACR,GAAMmB,CAAAA,GAAG,CAAG,2DAAZ,CACH;AAEG7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACjBb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADA,CAEjBe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFY,CAAhB,EAGGuB,IAHH,CAGQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EACA,MAAI,CAACzC,QAAL,CAAc,CAACY,UAAU,CAAC,IAAZ,CAAd,EACC,CAND,EAQH,KAAK8B,iBAAL,GACC,C,2BAGF,sBAAa,CACb,GAAG,KAAK/B,KAAL,CAAWG,KAAd,CAAoB,CACnB6B,KAAK,CAAC,0CAAD,CAAL,CACA,CAFD,IAGK,IAAG,KAAKhC,KAAL,CAAWE,QAAd,CAAuB,CAC3BqB,OAAO,CAACC,GAAR,CAAY,IAAZ,EACD,KAAKS,QAAL,GACA,KAAKC,UAAL,GACC,CAJI,IAKD,CACJ,KAAKD,QAAL,GAEC,CACA,C,wBAKD,mBAAU,CACN,GAAMP,CAAAA,GAAG,gEAA2D,KAAK1B,KAAL,CAAWa,GAAtE,CAAT,CACH;AAEGhC,KAAK,CAACsD,MAAN,CAAaT,GAAb,CAAkB,CAAEU,IAAI,CAAC,CAACR,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAAN,CAAP,CAAlB,EAA8DuB,IAA9D,CAAmE,SAACC,QAAD,CAAc,CACjFP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EAEC,CAHD,EAIF,KAAKzC,QAAL,CAAc,CAACY,UAAU,CAAC,KAAZ,CAAd,EACD,C,0BAED,qBAAY,CACR,GAAMyB,CAAAA,GAAG,kEAA6D,KAAK1B,KAAL,CAAWa,GAAxE,CAAT,CACH;AAEGhC,KAAK,CAACsD,MAAN,CAAaT,GAAb,CAAkB,CAAEU,IAAI,CAAC,CAACR,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAAN,CAAP,CAAlB,EAEGuB,IAFH,CAEQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EAEC,CALD,EAMA,KAAKzC,QAAL,CAAc,CAACa,QAAQ,CAAC,KAAV,CAAd,EACH,C,iCAOA,4BAAmB,iBAChB,GAAMwB,CAAAA,GAAG,CAAG,uDAAZ,CACA;AAEA7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACjBb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADA,CAEjBe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFY,CAAhB,EAGGuB,IAHH,CAGQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EACA,MAAI,CAACzC,QAAL,CAAc,CAACY,UAAU,CAAC,IAAZ,CAAd,EACC,CAND,EASF,CAEF;wBACC,mBAAU,iBACP,GAAMyB,CAAAA,GAAG,wDAAT,CACA;AAEA7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACjBb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADA,CAEjBe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFY,CAAhB,EAGGuB,IAHH,CAGQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EACA,MAAI,CAACzC,QAAL,CAAc,CAACa,QAAQ,CAAC,IAAV,CAAd,EACC,CAND,EAOF,C,qBAEC,gBAAO,CACL,GAAG,CAAC,KAAKF,KAAL,CAAWC,UAAf,CAA0B,CAC5B+B,KAAK,CAAC,2CAAD,CAAL,CACA,CAFE,IAGC,CACH,KAAKK,QAAL,GACA,GAAG,KAAKrC,KAAL,CAAWkB,IAAX,CAAkB,KAAKlB,KAAL,CAAWiB,QAAhC,CAAyC,CACxCe,KAAK,CAAC,0CAAD,CAAL,CACA,CAFD,IAGI,CACH,KAAKM,QAAL,GACA,CACD,CACC,C,4BAED,uBAAc,iBACT,GAAMZ,CAAAA,GAAG,yDAAoD,KAAK1B,KAAL,CAAWa,GAA/D,aAAT,CACN;AACEhC,KAAK,CAACM,GAAN,CAAUuC,GAAV,EAAeG,IAAf,CAAoB,SAAAU,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACH,IAAX,CAAgB,CAA1C,EACCP,IADD,CACM,SAACC,QAAD,CAAc,CACpB,MAAI,CAACzC,QAAL,CAAc,CAAC4B,QAAQ,CAACa,QAAQ,CAAC,CAAD,CAAR,CAAY,UAAZ,CAAV,CAAd,EACAP,OAAO,CAACC,GAAR,CAAY,MAAI,CAACxB,KAAL,CAAWiB,QAAvB,EACC,CAJD,EAKA,C,wBAED,mBAAU,iBACT,GAAMS,CAAAA,GAAG,iEAA4D7B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAA5D,CAAT,CACA;AACCzB,KAAK,CAACM,GAAN,CAAUuC,GAAV,CAAc,CAChBc,MAAM,CAAC,CACP3B,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADV,CADS,CAAd,EAGEgB,IAHF,CAGO,SAAAU,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACH,IAAX,CAAgB,CAH7B,EAIAP,IAJA,CAIK,SAACC,QAAD,CAAc,CACpB,MAAI,CAACzC,QAAL,CAAc,CAAC6B,IAAI,CAACY,QAAQ,CAAC,CAAD,CAAR,CAAY,QAAZ,CAAN,CAAd,EACC,CANA,EAOD,C,+FAEH,+JACC,KAAK7C,UAAL,CAAkB,IAAlB,CACE;AACKyC,GAHR,uDAG4D,KAAK1B,KAAL,CAAWa,GAHvE,wBAIuBhC,CAAAA,KAAK,CAACM,GAAN,CAAUuC,GAAV,EACjBG,IADiB,CACZ,SAAAU,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACH,IAAX,CAAgB,CADV,EAEjBP,IAFiB,CAEX,SAAAY,MAAM,CAAG,CAClB,GAAG,MAAI,CAACxD,UAAR,CAAmB,CACnB;AACM,MAAI,CAACI,QAAL,CAAc,CAACkB,MAAM,CAACkC,MAAR,CAAd,CAA8B,UAAI,CAAClB,OAAO,CAACC,GAAR,CAAY,MAAI,CAACxB,KAAL,CAAWO,MAAvB,EAAgC,CAAnE,EACA,MAAI,CAAClB,QAAL,CAAc,CAACmB,UAAU,CAAC,MAAI,CAACR,KAAL,CAAWO,MAAvB,CAAd,EAA+C,CACjD,CAPgB,CAJvB,QAIWgC,GAJX,0E,oLAcG,oKACOb,GADP,kEACuE,KAAK1B,KAAL,CAAWa,GADlF,EAEH;AAFG,uBAGgBhC,CAAAA,KAAK,CAACM,GAAN,CAAUuC,GAAV,EACjBG,IADiB,CACZ,SAAAU,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACH,IAAX,CAAgB,CADV,EAEjBP,IAFiB,CAEX,SAAAY,MAAM,CAAG,CACf,GAAG,MAAI,CAACxD,UAAR,CAAmB,CACnBsC,OAAO,CAACC,GAAR,CAAYiB,MAAZ,EACA,MAAI,CAACpD,QAAL,CAAc,CAAC2B,IAAI,CAACyB,MAAN,CAAd,CAA4B,UAAI,CAAClB,OAAO,CAACC,GAAR,CAAY,MAAI,CAACxB,KAAL,CAAWgB,IAAvB,EAA8B,CAA/D,EACA,MAAI,CAAC3B,QAAL,CAAc,CAAC0B,QAAQ,CAAC,MAAI,CAACf,KAAL,CAAWgB,IAArB,CAAd,EAA2C,CAC1C,CAPgB,CAHhB,QAGIuB,GAHJ,6E,oHAaF,iBAAQ,iBAEH,GAAMb,CAAAA,GAAG,CAAG,yDAAZ,CACN;AACQ7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACtBb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADK,CAEtBe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFiB,CAAhB,EAGFuB,IAHE,CAGG,SAACC,QAAD,CAAc,CACvBP,OAAO,CAACC,GAAR,CAAYM,QAAQ,CAACM,IAArB,EACA,MAAI,CAAC/C,QAAL,CAAc,CAACY,UAAU,CAAE6B,QAAQ,CAACM,IAAT,CAAc,WAAd,CAAb,CAAd,EACE,CANI,EAOP,C,0BAED,qBAAY,kBACXb,OAAO,CAACC,GAAR,CAAY,OAAZ,EACC,GAAME,CAAAA,GAAG,CAAG,uDAAZ,CACD;AACA7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACbb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADJ,CAEbe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFQ,CAAhB,EAGIuB,IAHJ,CAGS,SAACC,QAAD,CAAc,CACpBP,OAAO,CAACC,GAAR,CAAYM,QAAQ,CAACM,IAArB,EACA,OAAI,CAAC/C,QAAL,CAAc,CAACa,QAAQ,CAAE4B,QAAQ,CAACM,IAAT,CAAc,SAAd,CAAX,CAAd,EACD,CANF,EAOG,C,wBAEJ,mBAAU,kBACTb,OAAO,CAACC,GAAR,CAAY,OAAZ,EACC,GAAME,CAAAA,GAAG,CAAG,qDAAZ,CACD;AACA7C,KAAK,CAAC8C,IAAN,CAAWD,GAAX,CAAgB,CACbb,GAAG,CAAG,KAAKb,KAAL,CAAWa,GADJ,CAEbe,GAAG,CAAE/B,YAAY,CAACS,OAAb,CAAqB,KAArB,CAFQ,CAAhB,EAGIuB,IAHJ,CAGS,SAACC,QAAD,CAAc,CACpBP,OAAO,CAACC,GAAR,CAAYM,QAAQ,CAACM,IAArB,EACA,OAAI,CAAC/C,QAAL,CAAc,CAACc,KAAK,CAAE2B,QAAQ,CAACM,IAAT,CAAc,OAAd,CAAR,CAAd,EACD,CANF,EAOG,C,kCAIL;AACC,4BAAmBM,CAAnB,CAAsB,CACrB,KAAKrD,QAAL,CAAc,CAACyB,aAAa,CAAE4B,CAAC,CAACC,MAAF,CAASC,KAAzB,CAAd,EACA,C,qGAED,0KACK,KAAK5C,KAAL,CAAWc,aAAX,GAA2B,EADhC,2BAEE,KAAK3B,GAAL,GAFF,8BAIQuC,GAJR,qDAI0D,KAAK1B,KAAL,CAAWc,aAJrE,EAKC;AALD,uBAMqBjC,CAAAA,KAAK,CAACM,GAAN,CAAUuC,GAAV,CAAc,CACjCc,MAAM,CAAE,CACN3B,GAAG,CAAE,KAAKb,KAAL,CAAWa,GADV,CADyB,CAAd,EAKjBgB,IALiB,CAKZ,SAAAU,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACH,IAAX,CAAgB,CALV,EAMjBP,IANiB,CAMX,SAAAY,MAAM,CAAG,CAEflB,OAAO,CAACC,GAAR,CAAYiB,MAAZ,EACA,OAAI,CAACpD,QAAL,CAAc,CAACkB,MAAM,CAACkC,MAAR,CAAd,CAA8B,UAAI,CAAClB,OAAO,CAACC,GAAR,CAAY,OAAI,CAACxB,KAAL,CAAWO,MAAvB,EAAgC,CAAnE,EACA,OAAI,CAAClB,QAAL,CAAc,CAACmB,UAAU,CAAC,OAAI,CAACR,KAAL,CAAWO,MAAvB,CAAd,EACC,CAXgB,CANrB,QAMSgC,GANT,6E,kGA8BA,iBAAS,kBACR,GAAMM,CAAAA,IAAI,CAAG,KAAK7C,KAAL,CAAWe,QAAX,CAAoB+B,GAApB,CAAwB,SAAClD,KAAD,CAAW,CAC/C,mBAEI,2BAAK,SAAS,CAAC,UAAf,eAEF,4CACA,2BAAK,GAAG,CAAE,MAAMA,KAAK,CAACmD,GAAtB,CAA2B,SAAS,CAAC,UAArC,EADA,cAGC,0BAAI,KAAK,CAAC,UAAV,EAAsBnD,KAAK,CAACoD,KAA5B,CAHD,cAIC,0BAAI,KAAK,CAAC,UAAV,gBAAiCpD,KAAK,CAACqD,MAAvC,CAJD,cAMC,2BAAK,KAAK,CAAC,iBAAX,EAND,CAFE,CAFJ,CAkBA,CAnBY,CAAb,CAoBA1B,OAAO,CAACC,GAAR,CAAY,KAAKxB,KAAL,CAAWC,UAAvB,EACA,mBACS,4CAEP,2BAAK,SAAS,CAAC,WAAf,eACA,2BAAK,SAAS,CAAC,gBAAf,uBADA,cAEA,+BAAM4C,IAAN,CAFA,CAFO,cAMC,2BAAK,SAAS,CAAC,QAAf,EAND,cAQR,2BAAK,SAAS,CAAC,QAAf,eACA,6BAAO,SAAS,CAAC,eAAjB,CAAiC,QAAQ,KAAzC,CAA0C,QAAQ,CAAE,KAAKK,kBAAL,CAAwBC,IAAxB,CAA6B,IAA7B,CAApD,EADA,cAEA,8BAAQ,SAAS,CAAC,cAAlB,CAAgC,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACC,MAAL,EAAJ,EAAzC,YAFA,CARQ,cAaR,2BAAK,SAAS,CAAC,gBAAf,eAEa,2BAAK,GAAG,CAAG,MAAM,KAAKpD,KAAL,CAAWY,MAA5B,CAAqC,SAAS,CAAC,MAA/C,EAFb,cAGS,yBAAG,SAAS,CAAC,cAAb,EAA6B,KAAKZ,KAAL,CAAWW,KAAxC,CAHT,CAIC,CAAC,KAAKX,KAAL,CAAWC,UAAZ,eAAwB,8BAAQ,SAAS,CAAC,iBAAlB,CAAqC,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACoD,SAAL,EAAJ,EAA9C,cAAxB,eAAgH,8BAAQ,SAAS,CAAC,iBAAlB,CAAoC,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACC,WAAL,EAAJ,EAA7C,sBAJjH,CAKC,CAAC,KAAKtD,KAAL,CAAWE,QAAZ,eAAsB,8BAAQ,SAAS,CAAC,iBAAlB,CAAqC,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACqD,KAAL,EAAJ,EAA9C,yBAAtB,eAAqH,8BAAQ,SAAS,CAAC,iBAAlB,aALtH,CAbQ,cAsBR,2BAAK,SAAS,CAAC,MAAf,eAGA,8BAAQ,SAAS,CAAC,YAAlB,CAA8B,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACC,UAAL,EAAJ,EAAvC,iBAHA,cAIS,8BAAQ,SAAS,CAAC,YAAlB,CAA+B,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACC,SAAL,EAAJ,EAAxC,sBAJT,CAtBQ,cA6BR,2BAAK,SAAS,CAAC,cAAf,eACA,+BACC,KAAKzD,KAAL,CAAWV,MAAX,EAAmB,KAAKU,KAAL,CAAWQ,UAAX,CAAsBsC,GAAtB,CAA0B,SAAClD,KAAD,CAAW,CAC1D;AACA,mBAEC,2BAAK,SAAS,CAAC,MAAf,eACC,2BAAK,SAAS,CAAC,OAAf,eACA,oBAAC,IAAD,EAAM,EAAE,CAAE,aAAa,OAAI,CAACI,KAAL,CAAWa,GAAxB,CAA4B,UAA5B,CAAuCjB,KAAK,CAACG,GAAvD,CAA6D,OAAO,CAAE,yBAAI,CAAA,OAAI,CAACJ,KAAL,CAAWC,KAAX,CAAJ,EAAtE,MAA+FA,KAAK,CAAC8D,KAArG,KADA,cAEA,2BAAK,SAAS,CAAC,MAAf,aAA0B9D,KAAK,CAAC6B,QAAhC,uBAA8C7B,KAAK,CAAC0B,GAApD,CAFA,CADD,cAKE,2BAAK,SAAS,CAAC,SAAf,eACA,2BAAK,SAAS,CAAC,aAAf,EAA8B1B,KAAK,CAAC+D,WAApC,CADA,cAEA,oBAAC,KAAD,EAAO,MAAM,KAAb,CAAc,GAAG,CAAE,MAAM/D,KAAK,CAACmD,GAA/B,CAAoC,GAAG,CAAEnD,KAAK,CAACgE,QAA/C,CAAyD,SAAS,CAAC,UAAnE,EAFA,CALF,CAFD,CAcA,CAhBqB,CADpB,CADA,CA7BQ,CADT,CA4DA,C,4BA3Y0CjF,S,SAAvBI,c","sourcesContent":["import React from 'react';\r\nimport { Component } from 'react';  \r\nimport './singlePlatForm.css'\r\nimport { Media } from 'reactstrap';\r\nimport Axios from \"axios\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nexport default class singlePlatForm extends Component {\r\n\t_isMounted = false;\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\t//决定是否显示subscribe按钮和订阅按钮\r\n\t\t\tsubscribed:false,\r\n\t\t\tco_owner:false,\r\n\t\t\towner:false,\r\n\t\t\tauthority:false,\r\n\t\t\tlogged:localStorage.getItem(\"Logged\"),\r\n\t\t\tplaces: '',\r\n            renderList:[{}],\r\n\t\t\thotac:true,\r\n\t\t\trateac:true,\r\n\t\t\tPname :localStorage.getItem('Pname'),\r\n\t\t\tPcover:localStorage.getItem('Pcover'),\r\n\t\t\tPID: localStorage.getItem('PID'),\r\n\t\t\trander:false,\r\n\t\t\tsearchContent:\"\",\r\n\t\t\trankList:[{}],\r\n\t\t\trank:'',\r\n\t\t\treplimit:0,\r\n\t\t\tUrep:0\r\n\t\t};\r\n        \r\n\t}\r\n    \r\n\r\n\t\r\n componentDidMount=()=>{\r\n\tthis.get() ;\r\n\tthis.get_ranklist();\r\n\tthis.setState({rander:true});\r\n\tthis.is_sub();\r\n\tthis.is_coowner();\r\n\tthis.is_owner();\r\n\tthis.get_replimit();\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// Sort function \r\n\tsortByHot(){ \r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.hotac){\r\n          places.sort(function(a, b){return -a.hot + b.hot});\r\n\t\t   this.setState({hotac:false});\r\n\t\t}\r\n\t\telse{\r\n\t\t places.sort(function(a, b){return a.hot - b.hot}); \r\n\t\t this.setState({hotac:true});\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState({rateac:true})\r\n\t\tconsole.log(places)\r\n\t\t\r\n\t\tthis.setState({renderList: places })\r\n\t}\r\n\t\r\n\tsortByRate(){\r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.rateac){\r\n\t\t\tplaces.sort(function(a, b){return -a.ave_rate + b.ave_rate}); \r\n\t\t\tthis.setState({rateac:false})\r\n\t\t  }\r\n\t\t  else{\r\n\t\t   places.sort(function(a, b){return a.ave_rate - b.ave_rate}); \r\n\t\t   this.setState({rateac:true})\r\n\t\t  }\r\n\t\t  this.setState({hotac:true})\r\n\t\tconsole.log(places)\r\n\t\tthis.setState({renderList: places })\r\n\r\n\t}\r\n \r\n\r\n\r\n\t//申请和订阅在这里\r\n\tsubscribe(){\r\n    const url = 'https://juice-quiz.herokuapp.com/api/platform/dosubscribe';\r\n\t//   const url= 'http://localhost:3001/api/platform/dosubscribe';\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({subscribed:true})\r\n\t\t  }); \r\n\t \r\n\tthis.inital_reputation()\t\r\n\t}\r\n\r\n\r\nunsubscribe(){\r\nif(this.state.owner){\r\n\talert(\"You can't unsubscribe your own platform!\")\r\n}\r\nelse if(this.state.co_owner){\r\n\tconsole.log(\"co\");\r\nthis.op_unsub();\r\nthis.op_uncoown();\r\n}\r\nelse{\r\nthis.op_unsub();\r\n\r\n}\r\n}\r\n\r\n\r\n\r\n\r\nop_unsub(){\r\n    const url = `https://juice-quiz.herokuapp.com/api/platform/delSub/${this.state.PID}`;\r\n\t//const url= `http://localhost:3001/api/platform/delSub/${this.state.PID}`;\r\n\t     \r\n\t\t  Axios.delete(url, { data:{UID: localStorage.getItem(\"UID\")}}).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t \r\n\t\t  }); \r\n\t this.setState({subscribed:false})\r\n}\r\n\r\nop_uncoown(){\r\n    const url = `https://juice-quiz.herokuapp.com/api/platform/delCoown/${this.state.PID}`;\r\n\t//const url= `http://localhost:3001/api/platform/delCoown/${this.state.PID}`;\r\n\t     \r\n\t\t  Axios.delete(url, { data:{UID: localStorage.getItem(\"UID\")}\r\n\t\t\t\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  \r\n\t\t  }); \r\n\t\t  this.setState({co_owner:false})\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\t\r\n\tinital_reputation(){\r\n\t   const url = 'https://juice-quiz.herokuapp.com/api/platform/initalR';\r\n\t   //const url= 'http://localhost:3001/api/platform/initalR';\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({subscribed:true})\r\n\t\t  }); \r\n\r\n\r\n\t}\r\n\r\n// Apply function \r\n\tdo_apply(){\r\n\t\t  const url = `https://juice-quiz.herokuapp.com/api/platform/doapply`;\r\n\t\t  //const url= `http://localhost:3001/api/platform/doapply`;\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({co_owner:true})\r\n\t\t  }); \r\n\t};\r\n      \r\n   apply(){\r\n     if(!this.state.subscribed){\r\n\t\t alert(\"You need to subscribe the platform first!\")\r\n\t }\r\n\t else{\r\n\t\t this.get_Urep();\r\n\t\t if(this.state.Urep < this.state.replimit){\r\n\t\t\t alert(\"You didn't reach the co-owner requirment\")\r\n\t\t }\r\n\t\t else{\r\n\t\t\t this.do_apply();\r\n\t\t }\r\n\t }\r\n   }\r\n\r\n   get_replimit(){\r\n        const url = `https://juice-quiz.herokuapp.com/api/platform/${this.state.PID}/replimit`;\r\n\t\t//  const url= `http://localhost:3001/api/platform/${this.state.PID}/replimit`;\r\n\t\t  Axios.get(url).then(res=>{return res.data})\r\n\t\t  .then((response) => {   \r\n\t\t  this.setState({replimit:response[0]['replimit']});\r\n\t\t  console.log(this.state.replimit)\r\n\t\t  });\r\n   };\r\n\r\n   get_Urep(){\r\n\t   const url = `https://juice-quiz.herokuapp.com/api/platform/userRep/${localStorage.getItem(\"UID\")}`;\r\n\t   //const url= `http://localhost:3001/api/platform/userRep/${localStorage.getItem(\"UID\")}`;\r\n\t    Axios.get(url,{\r\n\t\t\tparams:{\r\n\t\t\tPID : this.state.PID,}\r\n\t   }).then(res=>{return res.data})\r\n\t   .then((response) => {   \r\n\t   this.setState({Urep:response[0]['Rpoint']});\r\n\t   });\r\n   };\r\n\r\n\tasync get(){\r\n\t\tthis._isMounted = true;\r\n    //  const url = `https://juice-quiz.herokuapp.com/api/platform/quizlist/${this.state.PID}`;\r\n\t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\r\n      const res = await Axios.get(url)\r\n      .then(res=>{return res.data})\r\n      .then( result =>{\r\n\t\t  if(this._isMounted){\r\n\t\t  //console.log(result);\r\n          this.setState({places:result},()=>{console.log(this.state.places);});\r\n          this.setState({renderList:this.state.places});}          \r\n       });\r\n    };\r\n\r\n    async get_ranklist(){\r\n\t    const url = `https://juice-quiz.herokuapp.com/api/platform/ranklist/${this.state.PID}`;\r\n\t//\tconst url= `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\r\n\t\tconst res = await Axios.get(url)\r\n\t\t.then(res=>{return res.data})\r\n\t\t.then( result =>{\r\n\t\t\tif(this._isMounted){\r\n\t\t\tconsole.log(result);\r\n\t\t\tthis.setState({rank:result},()=>{console.log(this.state.rank);});\r\n\t\t\tthis.setState({rankList:this.state.rank});}          \r\n\t\t });\r\n\t};\r\n\r\n\t is_sub(){\r\n\t\t\r\n       const url = 'https://juice-quiz.herokuapp.com/api/platform/subscribe';\r\n\t//\t const url= `http://localhost:3001/api/platform/subscribe`;\r\n         Axios.post(url, {\r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => {\r\n\t\t\tconsole.log(response.data);\r\n\t\t\tthis.setState({subscribed: response.data[\"subscribe\"]})\r\n\t\t  });\r\n\t};\r\n   \r\n\tis_coowner(){\r\n\t\tconsole.log(\"start\")\r\n\t\t const url = 'https://juice-quiz.herokuapp.com/api/platform/coowner';\r\n\t\t//const url= `http://localhost:3001/api/platform/coowner`;\r\n\t\tAxios.post(url, {\r\n\t\t   PID : this.state.PID,\r\n\t\t   UID: localStorage.getItem(\"UID\"),\r\n\t\t }).then((response) => {\r\n\t\t   console.log(response.data);\r\n\t\t   this.setState({co_owner: response.data[\"coowner\"]})\r\n\t\t });\r\n    };\r\n\r\n\tis_owner(){\r\n\t\tconsole.log(\"start\")\r\n\t\t const url = 'https://juice-quiz.herokuapp.com/api/platform/owner';\r\n\t\t//const url= `http://localhost:3001/api/platform/owner`;\r\n\t\tAxios.post(url, {\r\n\t\t   PID : this.state.PID,\r\n\t\t   UID: localStorage.getItem(\"UID\"),\r\n\t\t }).then((response) => {\r\n\t\t   console.log(response.data);\r\n\t\t   this.setState({owner: response.data[\"owner\"]})\r\n\t\t });\r\n    };\r\n\r\n\r\n\r\n//Search \r\n\thandleChangeSearch(e) {  \r\n\t\tthis.setState({searchContent: e.target.value});   \r\n\t} ;\r\n\r\n\tasync search(){\r\n\t\tif (this.state.searchContent===\"\"){\r\n\t\t\tthis.get();\r\n\t\t}else{\r\n\t\t\tconst url= `https://juice-quiz.herokuapp.com/api/quiz/${this.state.searchContent}`;\r\n\t\t//const url= `http://localhost:3001/api/quiz/${this.state.searchContent}`;\r\n\t\t  const res = await Axios.get(url,{\r\n\t\t\tparams: {\r\n\t\t\t  PID: this.state.PID\t\t\t  \r\n\t\t\t}\r\n\t\t  })\r\n\t\t  .then(res=>{return res.data})\r\n\t\t  .then( result =>{\r\n\t\t\t\r\n\t\t\t  console.log(result);\r\n\t\t\t  this.setState({places:result},()=>{console.log(this.state.places);});\r\n\t\t\t  this.setState({renderList:this.state.places});        \r\n\t\t   });\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t};\r\n\r\nstore=(place)=>{\r\n\tlocalStorage.setItem('QID',place.QID);\r\n\t\r\n}\r\n\r\n\r\n\r\n\trender() {     \r\n\t\tconst menu = this.state.rankList.map((place) => {\r\n\t\t\treturn(\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t<div className=\"rankList\">   \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<div> \r\n\t\t\t\t\t<img src={'../'+place.pic} className=\"rankIcon\" />\r\n\t\t\t\t \r\n\t\t\t\t\t\t<h4 class=\"rankName\">{place.Uname}</h4> \r\n\t\t\t\t\t\t<h4 class=\"rankRepo\">reputation:{place.Rpoint}{}</h4> \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"reputationValue\"> \r\n\t\t\t\t\t\t \r\n\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t \r\n\t\t\t\t</div>\r\n\t\t\t   \r\n\t\t\t);\r\n\t\t});\r\n\t\tconsole.log(this.state.subscribed);\r\n\t\treturn (\r\n           <div>\r\n\t\t\t\t \r\n\t\t\t\t<div className=\"rankBoard\"> \r\n\t\t\t\t<div className=\"rankBoardTitle\"> reputation rank  </div>\r\n\t\t\t\t<div>{menu}</div>\r\n\t\t\t\t</div> \r\n            <div className=\"header\"> \r\n\t\t\t</div> \r\n\t\t\t<div className=\"search\"> \r\n\t\t\t<input className='searchContent' required onChange={this.handleChangeSearch.bind(this)}></input>\r\n\t\t\t<button className='searchButton'onClick={()=>this.search()}>Search </button>\r\n\t\t\t</div>   \r\n            \r\n\t\t\t<div className=\"platFormButton\">\r\n\t\t\t\t{/* 此处读取平台的图片！ */}\r\n                <img src= {'../'+this.state.Pcover}  className='icon'></img> \r\n            <h className='platFormName'>{this.state.Pname}</h>\r\n\t\t\t{!this.state.subscribed&&<button className='platformaccount'  onClick={()=>this.subscribe()}>subscribe</button>||<button className='platformaccount' onClick={()=>this.unsubscribe()} >subscribed √</button>}\r\n\t\t\t{!this.state.co_owner&&<button className='platformaccount'  onClick={()=>this.apply()}>Apply to be co-owner</button>||<button className='platformaccount' >Co-Owner</button>}\r\n          \r\n\t\t     \r\n            </div>\r\n\t\t\t<div className=\"sort\">\r\n\r\n\t\t\t\r\n\t\t\t<button className='sortButton'onClick={()=>this.sortByRate()}>⭐ Rate </button>\r\n            <button className='sortButton' onClick={()=>this.sortByHot()}>🔥 Hot </button>\r\n\t\t\t</div>\r\n \r\n\t\t\t<div className='platFormlist'> \r\n\t\t\t<div>\r\n\t\t\t{this.state.rander&&this.state.renderList.map((place) => {\r\n\t\t//console.log(this.state.places)\t\r\n\t\treturn(\r\n\t\t \r\n\t\t\t<div className=\"item\">  \r\n\t\t\t <div className='title'>\r\n\t\t\t\t<Link to={\"/platform/\"+this.state.PID+\"/answer/\"+place.QID } onClick={()=>this.store(place)}> {place.Qname} </Link>\r\n\t\t\t\t<div className='rate'>⭐: {place.ave_rate} 🔥：{place.hot}</div> \r\n\t\t\t </div >\r\n\t\t\t \t<div className='content'> \r\n\t\t\t\t <div className='discription'>{place.description}</div>\r\n\t\t\t \t<Media object src={'../'+place.pic} alt={place.Releaser} className='userIcon'/> \r\n\t\t\t\t </div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t);\r\n\t})}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t</div>\r\n\t\t\t </div>\r\n\t\t</div>\r\n\t\t)\r\n\t}\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}