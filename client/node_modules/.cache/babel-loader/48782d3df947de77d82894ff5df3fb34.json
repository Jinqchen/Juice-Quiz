{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\dry19\\\\Documents\\\\GitHub\\\\Juice-Quiz\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Component}from'react';import'./singlePlatForm.css';import{Media}from'reactstrap';import Axios from\"axios\";// const places = \n// \t[\n// \t\t{\n// \t\t\tid: 0,\n// \t\t\tname: 'user1',\n// \t\t\timage: './account.jpg', \n// \t\t\treputation:2\n// \t\t} ,\n// \t\t{\n// \t\t\tid: 0,\n// \t\t\tname: 'user3',\n// \t\t\timage: './popMusic.jpg',\n// \t\t\treputation:2\n// \t\t} ,{\n// \t\t\tid: 0,\n// \t\t\tname: 'user2',\n// \t\t\timage: './classicMusic.jpg',\n// \t\t\treputation:2\n// \t\t}  \t];\nvar singlePlatForm=/*#__PURE__*/function(_Component){_inherits(singlePlatForm,_Component);var _super=_createSuper(singlePlatForm);function singlePlatForm(props){var _this;_classCallCheck(this,singlePlatForm);_this=_super.call(this,props);_this._isMounted=false;_this.componentDidMount=function(){_this.get();_this.get_ranklist();_this.setState({rander:true});_this.is_sub();};_this.state={//决定是否显示subscribe按钮和订阅按钮\nsubscribed:false,authority:false,logged:localStorage.getItem(\"Logged\"),places:'',renderList:[{}],hotac:true,rateac:true,Pname:localStorage.getItem('Pname'),Pcover:localStorage.getItem('Pcover'),PID:localStorage.getItem('PID'),rander:false,searchContent:\"\",rankList:[{}],rank:''};return _this;}_createClass(singlePlatForm,[{key:\"sortByHot\",value:function sortByHot(){var places=this.state.places;if(this.state.hotac){places.sort(function(a,b){return-a.hot+b.hot;});this.setState({hotac:false});}else{places.sort(function(a,b){return a.hot-b.hot;});this.setState({hotac:true});}this.setState({rateac:true});console.log(places);this.setState({renderList:places});}},{key:\"sortByRate\",value:function sortByRate(){var places=this.state.places;if(this.state.rateac){places.sort(function(a,b){return-a.ave_rate+b.ave_rate;});this.setState({rateac:false});}else{places.sort(function(a,b){return a.ave_rate-b.ave_rate;});this.setState({rateac:true});}this.setState({hotac:true});console.log(places);this.setState({renderList:places});}//申请和订阅在这里\n},{key:\"subscribe\",value:function subscribe(){var _this2=this;var url='https://juice-quiz.herokuapp.com/api/platform/dosubscribe';//const url= 'http://localhost:3001/api/platform/dosubscribe';\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response);_this2.setState({subscribed:true});});this.inital_reputation();}},{key:\"inital_reputation\",value:function inital_reputation(){var _this3=this;var url='https://juice-quiz.herokuapp.com/api/platform/initalR';//const url= 'http://localhost:3001/api/platform/initalR';\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response);_this3.setState({subscribed:true});});}},{key:\"apply\",value:function apply(){this.setState({apply:true});}},{key:\"get\",value:// async get(){\t\n// \t\t// const url = 'https://juice-quiz.herokuapp.com/api/platform/quizlist';\n// \t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\n// \t\t await Axios.get(url, \n// \t\t  ).then(res=>{return res.data})\n// \t\t  .then((response) => {\n//           this.setState({places:response},() => console.log(this.state.places)) \t   \n// \t\t });\n// }\nfunction(){var _get=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this4=this;var url,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this._isMounted=true;url=\"https://juice-quiz.herokuapp.com/api/platform/quizlist/\".concat(this.state.PID);//const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\n_context.next=4;return Axios.get(url).then(function(res){return res.data;}).then(function(result){if(_this4._isMounted){//console.log(result);\n_this4.setState({places:result},function(){console.log(_this4.state.places);});_this4.setState({renderList:_this4.state.places});}});case 4:res=_context.sent;case 5:case\"end\":return _context.stop();}}},_callee,this);}));function get(){return _get.apply(this,arguments);}return get;}()},{key:\"get_ranklist\",value:function(){var _get_ranklist=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this5=this;var url,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:url=\"https://juice-quiz.herokuapp.com/api/platform/ranklist/\".concat(this.state.PID);//const url= `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\n_context2.next=3;return Axios.get(url).then(function(res){return res.data;}).then(function(result){if(_this5._isMounted){console.log(result);_this5.setState({rank:result},function(){console.log(_this5.state.rank);});_this5.setState({rankList:_this5.state.rank});}});case 3:res=_context2.sent;case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function get_ranklist(){return _get_ranklist.apply(this,arguments);}return get_ranklist;}()},{key:\"is_sub\",value:function is_sub(){var _this6=this;console.log(\"start\");var url='https://juice-quiz.herokuapp.com/api/platform/subscribe';//const url= `http://localhost:3001/api/platform/subscribe`;\nAxios.post(url,{PID:this.state.PID,UID:localStorage.getItem(\"UID\")}).then(function(response){console.log(response.data);console.log(\"end\");_this6.setState({subscribed:response.data[\"subscribe\"]});});}},{key:\"handleChangeSearch\",value:function handleChangeSearch(e){this.setState({searchContent:e.target.value});}},{key:\"search\",value:function(){var _search=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this7=this;var url,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(this.state.searchContent===\"\")){_context3.next=4;break;}this.get();_context3.next=8;break;case 4:url=\"https://juice-quiz.herokuapp.com/api/quiz/\".concat(this.state.searchContent);//const url= `http://localhost:3001/api/quiz/${this.state.searchContent}`;\n_context3.next=7;return Axios.get(url,{params:{PID:this.state.PID}}).then(function(res){return res.data;}).then(function(result){console.log(result);_this7.setState({places:result},function(){console.log(_this7.state.places);});_this7.setState({renderList:_this7.state.places});});case 7:res=_context3.sent;case 8:case\"end\":return _context3.stop();}}},_callee3,this);}));function search(){return _search.apply(this,arguments);}return search;}()},{key:\"render\",value:function render(){var _this8=this;var menu=this.state.rankList.map(function(place){return/*#__PURE__*/React.createElement(\"div\",{className:\"rankList\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{src:'../'+place.pic,className:\"rankIcon\"}),/*#__PURE__*/React.createElement(\"h4\",{class:\"rankName\"},place.Uname),/*#__PURE__*/React.createElement(\"h4\",{class:\"rankRepo\"},\"reputation:\",place.Rpoint),/*#__PURE__*/React.createElement(\"div\",{class:\"reputationValue\"})));});console.log(this.state.subscribed);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"rankBoard\"},/*#__PURE__*/React.createElement(\"div\",{className:\"rankBoardTitle\"},\" reputation rank  \"),/*#__PURE__*/React.createElement(\"div\",null,menu)),/*#__PURE__*/React.createElement(\"div\",{className:\"header\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"search\"},/*#__PURE__*/React.createElement(\"input\",{className:\"searchContent\",required:true,onChange:this.handleChangeSearch.bind(this)}),/*#__PURE__*/React.createElement(\"button\",{className:\"searchButton\",onClick:function onClick(){return _this8.search();}},\"Search \")),/*#__PURE__*/React.createElement(\"div\",{className:\"platFormButton\"},/*#__PURE__*/React.createElement(\"img\",{src:'../'+this.state.Pcover,className:\"icon\"}),/*#__PURE__*/React.createElement(\"h\",{className:\"platFormName\"},this.state.Pname),!this.state.subscribed&&/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\",onClick:function onClick(){return _this8.subscribe();}},\"subscribe\")||/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\"},\"subscribed \\u221A\"),!this.state.apply&&/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\",onClick:function onClick(){return _this8.apply();}},\"Apply to be co-owner\")||/*#__PURE__*/React.createElement(\"button\",{className:\"platformaccount\"},\"apply has been sent\")),/*#__PURE__*/React.createElement(\"div\",{className:\"sort\"},/*#__PURE__*/React.createElement(\"button\",{className:\"sortButton\",onClick:function onClick(){return _this8.sortByRate();}},\"\\u2B50 Rate \"),/*#__PURE__*/React.createElement(\"button\",{className:\"sortButton\",onClick:function onClick(){return _this8.sortByHot();}},\"\\uD83D\\uDD25 Hot \")),/*#__PURE__*/React.createElement(\"div\",{className:\"platFormlist\"},/*#__PURE__*/React.createElement(\"div\",null,this.state.rander&&this.state.renderList.map(function(place){//console.log(this.state.places)\t\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"title\"},place.Qname,/*#__PURE__*/React.createElement(\"div\",{className:\"rate\"},\"\\u2B50: \",place.ave_rate,\" \\uD83D\\uDD25\\uFF1A\",place.hot)),/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"discription\"},place.description),/*#__PURE__*/React.createElement(Media,{object:true,src:'../'+place.pic,alt:place.Releaser,className:\"userIcon\"})));}))));}}]);return singlePlatForm;}(Component);export{singlePlatForm as default};","map":{"version":3,"sources":["C:/Users/dry19/Documents/GitHub/Juice-Quiz/client/src/singlePlatform/singlePlatForm.js"],"names":["React","Component","Media","Axios","singlePlatForm","props","_isMounted","componentDidMount","get","get_ranklist","setState","rander","is_sub","state","subscribed","authority","logged","localStorage","getItem","places","renderList","hotac","rateac","Pname","Pcover","PID","searchContent","rankList","rank","sort","a","b","hot","console","log","ave_rate","url","post","UID","then","response","inital_reputation","apply","res","data","result","e","target","value","params","menu","map","place","pic","Uname","Rpoint","handleChangeSearch","bind","search","subscribe","sortByRate","sortByHot","Qname","description","Releaser"],"mappings":"+hCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,MAAO,sBAAP,CACA,OAASC,KAAT,KAAsB,YAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;GAEqBC,CAAAA,c,gHAEpB,wBAAYC,KAAZ,CAAmB,gDAClB,uBAAMA,KAAN,EADkB,MADnBC,UACmB,CADN,KACM,OAwBnBC,iBAxBmB,CAwBD,UAAI,CACtB,MAAKC,GAAL,GACA,MAAKC,YAAL,GACA,MAAKC,QAAL,CAAc,CAACC,MAAM,CAAC,IAAR,CAAd,EACA,MAAKC,MAAL,GAGA,CA/BmB,CAElB,MAAKC,KAAL,CAAa,CACZ;AACAC,UAAU,CAAC,KAFC,CAGZC,SAAS,CAAC,KAHE,CAIZC,MAAM,CAACC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAJK,CAKZC,MAAM,CAAE,EALI,CAMHC,UAAU,CAAC,CAAC,EAAD,CANR,CAOZC,KAAK,CAAC,IAPM,CAQZC,MAAM,CAAC,IARK,CASZC,KAAK,CAAEN,YAAY,CAACC,OAAb,CAAqB,OAArB,CATK,CAUZM,MAAM,CAACP,YAAY,CAACC,OAAb,CAAqB,QAArB,CAVK,CAWZO,GAAG,CAAER,YAAY,CAACC,OAAb,CAAqB,KAArB,CAXO,CAYZP,MAAM,CAAC,KAZK,CAaZe,aAAa,CAAC,EAbF,CAcZC,QAAQ,CAAC,CAAC,EAAD,CAdG,CAeZC,IAAI,CAAC,EAfO,CAAb,CAFkB,aAoBlB,C,oDAkBD,oBAAW,CACV,GAAIT,CAAAA,MAAM,CAAG,KAAKN,KAAL,CAAWM,MAAxB,CACA,GAAG,KAAKN,KAAL,CAAWQ,KAAd,CAAoB,CACZF,MAAM,CAACU,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAO,CAACD,CAAC,CAACE,GAAH,CAASD,CAAC,CAACC,GAAlB,CAAsB,CAAjD,EACL,KAAKtB,QAAL,CAAc,CAACW,KAAK,CAAC,KAAP,CAAd,EACF,CAHD,IAII,CACHF,MAAM,CAACU,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAOD,CAAAA,CAAC,CAACE,GAAF,CAAQD,CAAC,CAACC,GAAjB,CAAqB,CAAhD,EACA,KAAKtB,QAAL,CAAc,CAACW,KAAK,CAAC,IAAP,CAAd,EACA,CAED,KAAKX,QAAL,CAAc,CAACY,MAAM,CAAC,IAAR,CAAd,EACAW,OAAO,CAACC,GAAR,CAAYf,MAAZ,EAEA,KAAKT,QAAL,CAAc,CAACU,UAAU,CAAED,MAAb,CAAd,EACA,C,0BAED,qBAAY,CACX,GAAIA,CAAAA,MAAM,CAAG,KAAKN,KAAL,CAAWM,MAAxB,CACA,GAAG,KAAKN,KAAL,CAAWS,MAAd,CAAqB,CACpBH,MAAM,CAACU,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAO,CAACD,CAAC,CAACK,QAAH,CAAcJ,CAAC,CAACI,QAAvB,CAAgC,CAA3D,EACA,KAAKzB,QAAL,CAAc,CAACY,MAAM,CAAC,KAAR,CAAd,EACE,CAHH,IAIM,CACHH,MAAM,CAACU,IAAP,CAAY,SAASC,CAAT,CAAYC,CAAZ,CAAc,CAAC,MAAOD,CAAAA,CAAC,CAACK,QAAF,CAAaJ,CAAC,CAACI,QAAtB,CAA+B,CAA1D,EACA,KAAKzB,QAAL,CAAc,CAACY,MAAM,CAAC,IAAR,CAAd,EACA,CACD,KAAKZ,QAAL,CAAc,CAACW,KAAK,CAAC,IAAP,CAAd,EACFY,OAAO,CAACC,GAAR,CAAYf,MAAZ,EACA,KAAKT,QAAL,CAAc,CAACU,UAAU,CAAED,MAAb,CAAd,EAEA,CAOD;yBACA,oBAAW,iBAER,GAAMiB,CAAAA,GAAG,CAAG,2DAAZ,CACA;AAEAjC,KAAK,CAACkC,IAAN,CAAWD,GAAX,CAAgB,CACjBX,GAAG,CAAG,KAAKZ,KAAL,CAAWY,GADA,CAEjBa,GAAG,CAAErB,YAAY,CAACC,OAAb,CAAqB,KAArB,CAFY,CAAhB,EAGGqB,IAHH,CAGQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EACA,MAAI,CAAC9B,QAAL,CAAc,CAACI,UAAU,CAAC,IAAZ,CAAd,EACC,CAND,EAQH,KAAK2B,iBAAL,GAEC,C,iCAED,4BAAmB,iBAChB,GAAML,CAAAA,GAAG,CAAG,uDAAZ,CACA;AAEAjC,KAAK,CAACkC,IAAN,CAAWD,GAAX,CAAgB,CACjBX,GAAG,CAAG,KAAKZ,KAAL,CAAWY,GADA,CAEjBa,GAAG,CAAErB,YAAY,CAACC,OAAb,CAAqB,KAArB,CAFY,CAAhB,EAGGqB,IAHH,CAGQ,SAACC,QAAD,CAAc,CACtBP,OAAO,CAACC,GAAR,CAAYM,QAAZ,EACA,MAAI,CAAC9B,QAAL,CAAc,CAACI,UAAU,CAAC,IAAZ,CAAd,EACC,CAND,EASF,C,qBAGD,gBAAO,CACN,KAAKJ,QAAL,CAAc,CAACgC,KAAK,CAAC,IAAP,CAAd,EACA,C,mBAED;AACA;AACA;AACA;AACA;AACA;AACG;AACH;AAGA;4EAEA,+JACC,KAAKpC,UAAL,CAAkB,IAAlB,CACW8B,GAFZ,kEAE4E,KAAKvB,KAAL,CAAWY,GAFvF,EAGE;AAHF,sBAIuBtB,CAAAA,KAAK,CAACK,GAAN,CAAU4B,GAAV,EACjBG,IADiB,CACZ,SAAAI,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACC,IAAX,CAAgB,CADV,EAEjBL,IAFiB,CAEX,SAAAM,MAAM,CAAG,CAClB,GAAG,MAAI,CAACvC,UAAR,CAAmB,CACnB;AACM,MAAI,CAACI,QAAL,CAAc,CAACS,MAAM,CAAC0B,MAAR,CAAd,CAA8B,UAAI,CAACZ,OAAO,CAACC,GAAR,CAAY,MAAI,CAACrB,KAAL,CAAWM,MAAvB,EAAgC,CAAnE,EACA,MAAI,CAACT,QAAL,CAAc,CAACU,UAAU,CAAC,MAAI,CAACP,KAAL,CAAWM,MAAvB,CAAd,EAA+C,CACjD,CAPgB,CAJvB,QAIWwB,GAJX,0E,oLAeG,oKACIP,GADJ,kEACoE,KAAKvB,KAAL,CAAWY,GAD/E,EAEF;AAFE,uBAGgBtB,CAAAA,KAAK,CAACK,GAAN,CAAU4B,GAAV,EACjBG,IADiB,CACZ,SAAAI,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACC,IAAX,CAAgB,CADV,EAEjBL,IAFiB,CAEX,SAAAM,MAAM,CAAG,CACf,GAAG,MAAI,CAACvC,UAAR,CAAmB,CACnB2B,OAAO,CAACC,GAAR,CAAYW,MAAZ,EACA,MAAI,CAACnC,QAAL,CAAc,CAACkB,IAAI,CAACiB,MAAN,CAAd,CAA4B,UAAI,CAACZ,OAAO,CAACC,GAAR,CAAY,MAAI,CAACrB,KAAL,CAAWe,IAAvB,EAA8B,CAA/D,EACA,MAAI,CAAClB,QAAL,CAAc,CAACiB,QAAQ,CAAC,MAAI,CAACd,KAAL,CAAWe,IAArB,CAAd,EAA2C,CAC1C,CAPgB,CAHhB,QAGIe,GAHJ,6E,oHAeF,iBAAQ,iBACPV,OAAO,CAACC,GAAR,CAAY,OAAZ,EACO,GAAME,CAAAA,GAAG,CAAG,yDAAZ,CACP;AACMjC,KAAK,CAACkC,IAAN,CAAWD,GAAX,CAAgB,CACtBX,GAAG,CAAG,KAAKZ,KAAL,CAAWY,GADK,CAEtBa,GAAG,CAAErB,YAAY,CAACC,OAAb,CAAqB,KAArB,CAFiB,CAAhB,EAGFqB,IAHE,CAGG,SAACC,QAAD,CAAc,CACvBP,OAAO,CAACC,GAAR,CAAYM,QAAQ,CAACI,IAArB,EACAX,OAAO,CAACC,GAAR,CAAY,KAAZ,EACA,MAAI,CAACxB,QAAL,CAAc,CAACI,UAAU,CAAE0B,QAAQ,CAACI,IAAT,CAAc,WAAd,CAAb,CAAd,EACE,CAPI,EAQP,C,kCAGD,4BAAmBE,CAAnB,CAAsB,CACrB,KAAKpC,QAAL,CAAc,CAACgB,aAAa,CAAEoB,CAAC,CAACC,MAAF,CAASC,KAAzB,CAAd,EACA,C,qGAED,yKACK,KAAKnC,KAAL,CAAWa,aAAX,GAA2B,EADhC,2BAEE,KAAKlB,GAAL,GAFF,8BAIQ4B,GAJR,qDAI0D,KAAKvB,KAAL,CAAWa,aAJrE,EAKC;AALD,uBAMqBvB,CAAAA,KAAK,CAACK,GAAN,CAAU4B,GAAV,CAAc,CACjCa,MAAM,CAAE,CACNxB,GAAG,CAAE,KAAKZ,KAAL,CAAWY,GADV,CADyB,CAAd,EAKjBc,IALiB,CAKZ,SAAAI,GAAG,CAAE,CAAC,MAAOA,CAAAA,GAAG,CAACC,IAAX,CAAgB,CALV,EAMjBL,IANiB,CAMX,SAAAM,MAAM,CAAG,CAEfZ,OAAO,CAACC,GAAR,CAAYW,MAAZ,EACA,MAAI,CAACnC,QAAL,CAAc,CAACS,MAAM,CAAC0B,MAAR,CAAd,CAA8B,UAAI,CAACZ,OAAO,CAACC,GAAR,CAAY,MAAI,CAACrB,KAAL,CAAWM,MAAvB,EAAgC,CAAnE,EACA,MAAI,CAACT,QAAL,CAAc,CAACU,UAAU,CAAC,MAAI,CAACP,KAAL,CAAWM,MAAvB,CAAd,EACC,CAXgB,CANrB,QAMSwB,GANT,6E,kGA2BA,iBAAS,iBACR,GAAMO,CAAAA,IAAI,CAAG,KAAKrC,KAAL,CAAWc,QAAX,CAAoBwB,GAApB,CAAwB,SAACC,KAAD,CAAW,CAC/C,mBAEI,2BAAK,SAAS,CAAC,UAAf,eAEF,4CACA,2BAAK,GAAG,CAAE,MAAMA,KAAK,CAACC,GAAtB,CAA2B,SAAS,CAAC,UAArC,EADA,cAGC,0BAAI,KAAK,CAAC,UAAV,EAAsBD,KAAK,CAACE,KAA5B,CAHD,cAIC,0BAAI,KAAK,CAAC,UAAV,gBAAiCF,KAAK,CAACG,MAAvC,CAJD,cAMC,2BAAK,KAAK,CAAC,iBAAX,EAND,CAFE,CAFJ,CAkBA,CAnBY,CAAb,CAoBAtB,OAAO,CAACC,GAAR,CAAY,KAAKrB,KAAL,CAAWC,UAAvB,EACA,mBACS,4CAEP,2BAAK,SAAS,CAAC,WAAf,eACA,2BAAK,SAAS,CAAC,gBAAf,uBADA,cAEA,+BAAMoC,IAAN,CAFA,CAFO,cAMC,2BAAK,SAAS,CAAC,QAAf,EAND,cAQR,2BAAK,SAAS,CAAC,QAAf,eACA,6BAAO,SAAS,CAAC,eAAjB,CAAiC,QAAQ,KAAzC,CAA0C,QAAQ,CAAE,KAAKM,kBAAL,CAAwBC,IAAxB,CAA6B,IAA7B,CAApD,EADA,cAEA,8BAAQ,SAAS,CAAC,cAAlB,CAAgC,OAAO,CAAE,yBAAI,CAAA,MAAI,CAACC,MAAL,EAAJ,EAAzC,YAFA,CARQ,cAaR,2BAAK,SAAS,CAAC,gBAAf,eAEa,2BAAK,GAAG,CAAG,MAAM,KAAK7C,KAAL,CAAWW,MAA5B,CAAqC,SAAS,CAAC,MAA/C,EAFb,cAGS,yBAAG,SAAS,CAAC,cAAb,EAA6B,KAAKX,KAAL,CAAWU,KAAxC,CAHT,CAIC,CAAC,KAAKV,KAAL,CAAWC,UAAZ,eAAwB,8BAAQ,SAAS,CAAC,iBAAlB,CAAqC,OAAO,CAAE,yBAAI,CAAA,MAAI,CAAC6C,SAAL,EAAJ,EAA9C,cAAxB,eAAgH,8BAAQ,SAAS,CAAC,iBAAlB,sBAJjH,CAKC,CAAC,KAAK9C,KAAL,CAAW6B,KAAZ,eAAmB,8BAAQ,SAAS,CAAC,iBAAlB,CAAqC,OAAO,CAAE,yBAAI,CAAA,MAAI,CAACA,KAAL,EAAJ,EAA9C,yBAAnB,eAAkH,8BAAQ,SAAS,CAAC,iBAAlB,wBALnH,CAbQ,cAsBR,2BAAK,SAAS,CAAC,MAAf,eAGA,8BAAQ,SAAS,CAAC,YAAlB,CAA8B,OAAO,CAAE,yBAAI,CAAA,MAAI,CAACkB,UAAL,EAAJ,EAAvC,iBAHA,cAIS,8BAAQ,SAAS,CAAC,YAAlB,CAA+B,OAAO,CAAE,yBAAI,CAAA,MAAI,CAACC,SAAL,EAAJ,EAAxC,sBAJT,CAtBQ,cA6BR,2BAAK,SAAS,CAAC,cAAf,eACA,+BACC,KAAKhD,KAAL,CAAWF,MAAX,EAAmB,KAAKE,KAAL,CAAWO,UAAX,CAAsB+B,GAAtB,CAA0B,SAACC,KAAD,CAAW,CAC1D;AACA,mBAEC,2BAAK,SAAS,CAAC,MAAf,eACC,2BAAK,SAAS,CAAC,OAAf,EACEA,KAAK,CAACU,KADR,cAEC,2BAAK,SAAS,CAAC,MAAf,aAA0BV,KAAK,CAACjB,QAAhC,uBAA8CiB,KAAK,CAACpB,GAApD,CAFD,CADD,cAKE,2BAAK,SAAS,CAAC,SAAf,eACA,2BAAK,SAAS,CAAC,aAAf,EAA8BoB,KAAK,CAACW,WAApC,CADA,cAEA,oBAAC,KAAD,EAAO,MAAM,KAAb,CAAc,GAAG,CAAE,MAAMX,KAAK,CAACC,GAA/B,CAAoC,GAAG,CAAED,KAAK,CAACY,QAA/C,CAAyD,SAAS,CAAC,UAAnE,EAFA,CALF,CAFD,CAcA,CAhBqB,CADpB,CADA,CA7BQ,CADT,CA4DA,C,4BA9R0C/D,S,SAAvBG,c","sourcesContent":["import React from 'react';\r\nimport { Component } from 'react';  \r\nimport './singlePlatForm.css'\r\nimport { Media } from 'reactstrap';\r\nimport Axios from \"axios\";\r\n\r\n// const places = \r\n// \t[\r\n// \t\t{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user1',\r\n// \t\t\timage: './account.jpg', \r\n// \t\t\treputation:2\r\n\t\t\t \r\n// \t\t} ,\r\n// \t\t{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user3',\r\n// \t\t\timage: './popMusic.jpg',\r\n// \t\t\treputation:2\r\n// \t\t} ,{\r\n// \t\t\tid: 0,\r\n// \t\t\tname: 'user2',\r\n// \t\t\timage: './classicMusic.jpg',\r\n// \t\t\treputation:2\r\n// \t\t}  \t];\r\n\r\nexport default class singlePlatForm extends Component {\r\n\t_isMounted = false;\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\t//决定是否显示subscribe按钮和订阅按钮\r\n\t\t\tsubscribed:false,\r\n\t\t\tauthority:false,\r\n\t\t\tlogged:localStorage.getItem(\"Logged\"),\r\n\t\t\tplaces: '',\r\n            renderList:[{}],\r\n\t\t\thotac:true,\r\n\t\t\trateac:true,\r\n\t\t\tPname :localStorage.getItem('Pname'),\r\n\t\t\tPcover:localStorage.getItem('Pcover'),\r\n\t\t\tPID: localStorage.getItem('PID'),\r\n\t\t\trander:false,\r\n\t\t\tsearchContent:\"\",\r\n\t\t\trankList:[{}],\r\n\t\t\trank:''\r\n\t\t};\r\n        \r\n\t}\r\n    \r\n\r\n\t\r\n componentDidMount=()=>{\r\n\tthis.get() ;\r\n\tthis.get_ranklist();\r\n\tthis.setState({rander:true});\r\n\tthis.is_sub();\r\n\t\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tsortByHot(){ \r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.hotac){\r\n          places.sort(function(a, b){return -a.hot + b.hot});\r\n\t\t   this.setState({hotac:false});\r\n\t\t}\r\n\t\telse{\r\n\t\t places.sort(function(a, b){return a.hot - b.hot}); \r\n\t\t this.setState({hotac:true});\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState({rateac:true})\r\n\t\tconsole.log(places)\r\n\t\t\r\n\t\tthis.setState({renderList: places })\r\n\t}\r\n\t\r\n\tsortByRate(){\r\n\t\tvar places = this.state.places\r\n\t\tif(this.state.rateac){\r\n\t\t\tplaces.sort(function(a, b){return -a.ave_rate + b.ave_rate}); \r\n\t\t\tthis.setState({rateac:false})\r\n\t\t  }\r\n\t\t  else{\r\n\t\t   places.sort(function(a, b){return a.ave_rate - b.ave_rate}); \r\n\t\t   this.setState({rateac:true})\r\n\t\t  }\r\n\t\t  this.setState({hotac:true})\r\n\t\tconsole.log(places)\r\n\t\tthis.setState({renderList: places })\r\n\r\n\t}\r\n \r\n\r\n\r\n\r\n\r\n\r\n\t//申请和订阅在这里\r\n\tsubscribe(){\r\n\r\n\t   const url = 'https://juice-quiz.herokuapp.com/api/platform/dosubscribe';\r\n\t   //const url= 'http://localhost:3001/api/platform/dosubscribe';\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({subscribed:true})\r\n\t\t  }); \r\n\t \r\n\tthis.inital_reputation()\t\r\n\r\n\t}\r\n\r\n\tinital_reputation(){\r\n\t   const url = 'https://juice-quiz.herokuapp.com/api/platform/initalR';\r\n\t   //const url= 'http://localhost:3001/api/platform/initalR';\r\n\t     \r\n\t\t  Axios.post(url, { \r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => { \r\n\t\t  console.log(response); \r\n\t\t  this.setState({subscribed:true})\r\n\t\t  }); \r\n\r\n\r\n\t}\r\n\r\n\r\n\tapply(){\r\n\t\tthis.setState({apply:true})\r\n\t};\r\n    \r\n\t// async get(){\t\r\n\t// \t\t// const url = 'https://juice-quiz.herokuapp.com/api/platform/quizlist';\r\n\t// \t\t const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\r\n\t// \t\t await Axios.get(url, \r\n\t// \t\t  ).then(res=>{return res.data})\r\n\t// \t\t  .then((response) => {\r\n    //           this.setState({places:response},() => console.log(this.state.places)) \t   \r\n\t// \t\t });\r\n\t\t\t \r\n\t\t\t\t\t   \r\n\t// }\r\n\t\r\n\tasync get(){\r\n\t\tthis._isMounted = true;\r\n       const url = `https://juice-quiz.herokuapp.com/api/platform/quizlist/${this.state.PID}`;\r\n\t\t //const url= `http://localhost:3001/api/platform/quizlist/${this.state.PID}`;\r\n      const res = await Axios.get(url)\r\n      .then(res=>{return res.data})\r\n      .then( result =>{\r\n\t\t  if(this._isMounted){\r\n\t\t  //console.log(result);\r\n          this.setState({places:result},()=>{console.log(this.state.places);});\r\n          this.setState({renderList:this.state.places});}          \r\n       });\r\n    }\r\n    \r\n\r\n    async get_ranklist(){\r\n\t\tconst url = `https://juice-quiz.herokuapp.com/api/platform/ranklist/${this.state.PID}`;\r\n\t\t//const url= `http://localhost:3001/api/platform/ranklist/${this.state.PID}`;\r\n\t\tconst res = await Axios.get(url)\r\n\t\t.then(res=>{return res.data})\r\n\t\t.then( result =>{\r\n\t\t\tif(this._isMounted){\r\n\t\t\tconsole.log(result);\r\n\t\t\tthis.setState({rank:result},()=>{console.log(this.state.rank);});\r\n\t\t\tthis.setState({rankList:this.state.rank});}          \r\n\t\t });\r\n\t}\r\n\r\n\r\n\r\n\t is_sub(){\r\n\t\t console.log(\"start\")\r\n          const url = 'https://juice-quiz.herokuapp.com/api/platform/subscribe';\r\n\t\t //const url= `http://localhost:3001/api/platform/subscribe`;\r\n         Axios.post(url, {\r\n\t\t\tPID : this.state.PID,\r\n\t\t\tUID: localStorage.getItem(\"UID\"),\r\n\t\t  }).then((response) => {\r\n\t\t\tconsole.log(response.data);\r\n\t\t\tconsole.log(\"end\")\r\n\t\t\tthis.setState({subscribed: response.data[\"subscribe\"]})\r\n\t\t  });\r\n\t}\r\n   \r\n\r\n\thandleChangeSearch(e) {  \r\n\t\tthis.setState({searchContent: e.target.value});   \r\n\t} \r\n\r\n\tasync search(){\r\n\t\tif (this.state.searchContent===\"\"){\r\n\t\t\tthis.get();\r\n\t\t}else{\r\n\t\t\tconst url= `https://juice-quiz.herokuapp.com/api/quiz/${this.state.searchContent}`;\r\n\t\t//const url= `http://localhost:3001/api/quiz/${this.state.searchContent}`;\r\n\t\t  const res = await Axios.get(url,{\r\n\t\t\tparams: {\r\n\t\t\t  PID: this.state.PID\t\t\t  \r\n\t\t\t}\r\n\t\t  })\r\n\t\t  .then(res=>{return res.data})\r\n\t\t  .then( result =>{\r\n\t\t\t\r\n\t\t\t  console.log(result);\r\n\t\t\t  this.setState({places:result},()=>{console.log(this.state.places);});\r\n\t\t\t  this.setState({renderList:this.state.places});        \r\n\t\t   });\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\trender() {     \r\n\t\tconst menu = this.state.rankList.map((place) => {\r\n\t\t\treturn(\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t<div className=\"rankList\">   \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t<div> \r\n\t\t\t\t\t<img src={'../'+place.pic} className=\"rankIcon\" />\r\n\t\t\t\t \r\n\t\t\t\t\t\t<h4 class=\"rankName\">{place.Uname}</h4> \r\n\t\t\t\t\t\t<h4 class=\"rankRepo\">reputation:{place.Rpoint}{}</h4> \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"reputationValue\"> \r\n\t\t\t\t\t\t \r\n\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t \r\n\t\t\t\t</div>\r\n\t\t\t   \r\n\t\t\t);\r\n\t\t});\r\n\t\tconsole.log(this.state.subscribed);\r\n\t\treturn (\r\n           <div>\r\n\t\t\t\t \r\n\t\t\t\t<div className=\"rankBoard\"> \r\n\t\t\t\t<div className=\"rankBoardTitle\"> reputation rank  </div>\r\n\t\t\t\t<div>{menu}</div>\r\n\t\t\t\t</div> \r\n            <div className=\"header\"> \r\n\t\t\t</div> \r\n\t\t\t<div className=\"search\"> \r\n\t\t\t<input className='searchContent' required onChange={this.handleChangeSearch.bind(this)}></input>\r\n\t\t\t<button className='searchButton'onClick={()=>this.search()}>Search </button>\r\n\t\t\t</div>   \r\n            \r\n\t\t\t<div className=\"platFormButton\">\r\n\t\t\t\t{/* 此处读取平台的图片！ */}\r\n                <img src= {'../'+this.state.Pcover}  className='icon'></img> \r\n            <h className='platFormName'>{this.state.Pname}</h>\r\n\t\t\t{!this.state.subscribed&&<button className='platformaccount'  onClick={()=>this.subscribe()}>subscribe</button>||<button className='platformaccount' >subscribed √</button>}\r\n\t\t\t{!this.state.apply&&<button className='platformaccount'  onClick={()=>this.apply()}>Apply to be co-owner</button>||<button className='platformaccount' >apply has been sent</button>}\r\n          \r\n\t\t     \r\n            </div>\r\n\t\t\t<div className=\"sort\">\r\n\r\n\t\t\t\r\n\t\t\t<button className='sortButton'onClick={()=>this.sortByRate()}>⭐ Rate </button>\r\n            <button className='sortButton' onClick={()=>this.sortByHot()}>🔥 Hot </button>\r\n\t\t\t</div>\r\n \r\n\t\t\t<div className='platFormlist'> \r\n\t\t\t<div>\r\n\t\t\t{this.state.rander&&this.state.renderList.map((place) => {\r\n\t\t//console.log(this.state.places)\t\r\n\t\treturn(\r\n\t\t \r\n\t\t\t<div className=\"item\">  \r\n\t\t\t <div className='title'>\r\n\t\t\t\t {place.Qname} \r\n\t\t\t\t <div className='rate'>⭐: {place.ave_rate} 🔥：{place.hot}</div> \r\n\t\t\t </div >\r\n\t\t\t \t<div className='content'> \r\n\t\t\t\t <div className='discription'>{place.description}</div>\r\n\t\t\t \t<Media object src={'../'+place.pic} alt={place.Releaser} className='userIcon'/> \r\n\t\t\t\t </div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t);\r\n\t})}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t</div>\r\n\t\t\t </div>\r\n\t\t</div>\r\n\t\t)\r\n\t}\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}